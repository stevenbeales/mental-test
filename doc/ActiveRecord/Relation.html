<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class ActiveRecord::Relation - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link"><a href="../Object.html">Object</a>
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="../Enumerable.html">Enumerable</a>
  
  
  
    <li><a class="include" href="FinderMethods.html">ActiveRecord::FinderMethods</a>
  
  
  
    <li><a class="include" href="Calculations.html">ActiveRecord::Calculations</a>
  
  
  
    <li><a class="include" href="SpawnMethods.html">ActiveRecord::SpawnMethods</a>
  
  
  
    <li><a class="include" href="QueryMethods.html">ActiveRecord::QueryMethods</a>
  
  
  
    <li><a class="include" href="Batches.html">ActiveRecord::Batches</a>
  
  
  
    <li><a class="include" href="Explain.html">ActiveRecord::Explain</a>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-3D-3D">#==</a>
    
    <li class="calls-super" ><a href="#method-i-any-3F">#any?</a>
    
    <li ><a href="#method-i-blank-3F">#blank?</a>
    
    <li ><a href="#method-i-build">#build</a>
    
    <li ><a href="#method-i-cache_key">#cache_key</a>
    
    <li ><a href="#method-i-create">#create</a>
    
    <li ><a href="#method-i-create-21">#create!</a>
    
    <li ><a href="#method-i-delete">#delete</a>
    
    <li ><a href="#method-i-delete_all">#delete_all</a>
    
    <li ><a href="#method-i-destroy">#destroy</a>
    
    <li ><a href="#method-i-destroy_all">#destroy_all</a>
    
    <li ><a href="#method-i-eager_loading-3F">#eager_loading?</a>
    
    <li ><a href="#method-i-empty-3F">#empty?</a>
    
    <li ><a href="#method-i-encode_with">#encode_with</a>
    
    <li ><a href="#method-i-explain">#explain</a>
    
    <li ><a href="#method-i-find_or_create_by">#find_or_create_by</a>
    
    <li ><a href="#method-i-find_or_create_by-21">#find_or_create_by!</a>
    
    <li ><a href="#method-i-find_or_initialize_by">#find_or_initialize_by</a>
    
    <li ><a href="#method-i-initialize_copy">#initialize_copy</a>
    
    <li ><a href="#method-i-inspect">#inspect</a>
    
    <li ><a href="#method-i-joined_includes_values">#joined_includes_values</a>
    
    <li ><a href="#method-i-load">#load</a>
    
    <li ><a href="#method-i-load_records">#load_records</a>
    
    <li class="calls-super" ><a href="#method-i-many-3F">#many?</a>
    
    <li ><a href="#method-i-new">#new</a>
    
    <li class="calls-super" ><a href="#method-i-none-3F">#none?</a>
    
    <li class="calls-super" ><a href="#method-i-one-3F">#one?</a>
    
    <li ><a href="#method-i-pretty_print">#pretty_print</a>
    
    <li ><a href="#method-i-reload">#reload</a>
    
    <li ><a href="#method-i-reset">#reset</a>
    
    <li ><a href="#method-i-scope_for_create">#scope_for_create</a>
    
    <li ><a href="#method-i-scoping">#scoping</a>
    
    <li ><a href="#method-i-size">#size</a>
    
    <li ><a href="#method-i-to_a">#to_a</a>
    
    <li ><a href="#method-i-to_sql">#to_sql</a>
    
    <li ><a href="#method-i-update">#update</a>
    
    <li ><a href="#method-i-update_all">#update_all</a>
    
    <li ><a href="#method-i-values">#values</a>
    
    <li ><a href="#method-i-where_values_hash">#where_values_hash</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-ActiveRecord::Relation">
  <h1 id="class-ActiveRecord::Relation" class="class">
    class ActiveRecord::Relation
  </h1>

  <section class="description">
    
<h1 id="class-ActiveRecord::Relation-label-Active+Record+Relation">Active Record Relation<span><a href="#class-ActiveRecord::Relation-label-Active+Record+Relation">&para;</a> <a href="#top">&uarr;</a></span></h1>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="CLAUSE_METHODS">CLAUSE_METHODS
        
        <dd>
        
      
        <dt id="INVALID_METHODS_FOR_DELETE_ALL">INVALID_METHODS_FOR_DELETE_ALL
        
        <dd>
        
      
        <dt id="MULTI_VALUE_METHODS">MULTI_VALUE_METHODS
        
        <dd>
        
      
        <dt id="SINGLE_VALUE_METHODS">SINGLE_VALUE_METHODS
        
        <dd>
        
      
        <dt id="VALUE_METHODS">VALUE_METHODS
        
        <dd>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-klass" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">klass</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-loaded" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">loaded</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-loaded-3F" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">loaded?</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-model" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">model</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-predicate_builder" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">predicate_builder</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-table" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">table</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(klass, table, predicate_builder, values = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">klass</span>, <span class="ruby-identifier">table</span>, <span class="ruby-identifier">predicate_builder</span>, <span class="ruby-identifier">values</span> = {})
  <span class="ruby-ivar">@klass</span>  = <span class="ruby-identifier">klass</span>
  <span class="ruby-ivar">@table</span>  = <span class="ruby-identifier">table</span>
  <span class="ruby-ivar">@values</span> = <span class="ruby-identifier">values</span>
  <span class="ruby-ivar">@offsets</span> = {}
  <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@predicate_builder</span> = <span class="ruby-identifier">predicate_builder</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-3D-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">==</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Compares two relations for equality.</p>
          
          

          
          <div class="method-source-code" id="3D-3D-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 612</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Associations</span><span class="ruby-operator">::</span><span class="ruby-constant">CollectionProxy</span>, <span class="ruby-constant">AssociationRelation</span>
    <span class="ruby-keyword">self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">records</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Relation</span>
    <span class="ruby-identifier">other</span>.<span class="ruby-identifier">to_sql</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">to_sql</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
    <span class="ruby-identifier">records</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-any-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">any?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are any records.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="any-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 282</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">any?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-operator">!</span><span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-blank-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">blank?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if relation is blank.</p>
          
          

          
          <div class="method-source-code" id="blank-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 628</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">blank?</span>
  <span class="ruby-identifier">records</span>.<span class="ruby-identifier">blank?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-build" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">build</span><span
            class="method-args">(*args, &block)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Relation.html#method-i-new">new</a>
        </div>
        
      </div>

    
      <div id="method-i-cache_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cache_key</span><span
            class="method-args">(timestamp_column = :updated_at)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a cache key that can be used to identify the records fetched by
this query. The cache key is built with a fingerprint of the sql query, the
number of records matched by the query and a timestamp of the last updated
record. When a new record comes to match the query, or any of the existing
records is updated or deleted, the cache key changes.</p>

<pre class="ruby"><span class="ruby-constant">Product</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;name like ?&quot;</span>, <span class="ruby-string">&quot;%Cosmic Encounter%&quot;</span>).<span class="ruby-identifier">cache_key</span>
<span class="ruby-comment"># =&gt; &quot;products/query-1850ab3d302391b85b8693e941286659-1-20150714212553907087000&quot;</span>
</pre>

<p>If the collection is loaded, the method will iterate through the records to
generate the timestamp, otherwise it will trigger one SQL query like:</p>

<pre>SELECT COUNT(*), MAX(&quot;products&quot;.&quot;updated_at&quot;) FROM &quot;products&quot; WHERE (name like &#39;%Cosmic Encounter%&#39;)</pre>

<p>You can also pass a custom timestamp column to fetch the timestamp of the
last updated record.</p>

<pre class="ruby"><span class="ruby-constant">Product</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;name like ?&quot;</span>, <span class="ruby-string">&quot;%Game%&quot;</span>).<span class="ruby-identifier">cache_key</span>(:<span class="ruby-identifier">last_reviewed_at</span>)
</pre>

<p>You can customize the strategy to generate the key on a per model basis
overriding ActiveRecord::Base#collection_cache_key.</p>
          
          

          
          <div class="method-source-code" id="cache_key-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 320</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_key</span>(<span class="ruby-identifier">timestamp_column</span> = <span class="ruby-value">:updated_at</span>)
  <span class="ruby-ivar">@cache_keys</span> <span class="ruby-operator">||=</span> {}
  <span class="ruby-ivar">@cache_keys</span>[<span class="ruby-identifier">timestamp_column</span>] <span class="ruby-operator">||=</span> <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">collection_cache_key</span>(<span class="ruby-keyword">self</span>, <span class="ruby-identifier">timestamp_column</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create</span><span
            class="method-args">(*args, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tries to create a new record with the same scoped attributes defined in the
relation. Returns the initialized object if validation fails.</p>

<p>Expects arguments in the same format as <a
href="Persistence/ClassMethods.html#method-i-create">ActiveRecord::Base.create</a>.</p>

<h4 id="method-i-create-label-Examples">Examples<span><a href="#method-i-create-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-identifier">users</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Oscar&#39;</span>)
<span class="ruby-identifier">users</span>.<span class="ruby-identifier">create</span> <span class="ruby-comment"># =&gt; #&lt;User id: 3, name: &quot;Oscar&quot;, ...&gt;</span>

<span class="ruby-identifier">users</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;fxn&#39;</span>)
<span class="ruby-identifier">users</span>.<span class="ruby-identifier">create</span> <span class="ruby-comment"># =&gt; #&lt;User id: 4, name: &quot;fxn&quot;, ...&gt;</span>

<span class="ruby-identifier">users</span>.<span class="ruby-identifier">create</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;tenderlove&#39;</span> }
<span class="ruby-comment"># =&gt; #&lt;User id: 5, name: &quot;tenderlove&quot;, ...&gt;</span>

<span class="ruby-identifier">users</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>) <span class="ruby-comment"># validation on name</span>
<span class="ruby-comment"># =&gt; #&lt;User id: nil, name: nil, ...&gt;</span>
</pre>
          
          

          
          <div class="method-source-code" id="create-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 145</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">create</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-create-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create!</span><span
            class="method-args">(*args, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Similar to <a href="Relation.html#method-i-create">create</a>, but calls <a
href="Persistence/ClassMethods.html#method-i-create-21">create!</a> on the
base class. Raises an exception if a validation error occurs.</p>

<p>Expects arguments in the same format as <a
href="Persistence/ClassMethods.html#method-i-create-21">ActiveRecord::Base.create!</a>.</p>
          
          

          
          <div class="method-source-code" id="create-21-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create!</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">create!</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete</span><span
            class="method-args">(id_or_array)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Deletes the row with a primary key matching the <code>id</code> argument,
using a SQL <code>DELETE</code> statement, and returns the number of rows
deleted. Active Record objects are not instantiated, so the object&#39;s
callbacks are not executed, including any <code>:dependent</code>
association options.</p>

<p>You can delete multiple rows at once by passing an <a
href="../Array.html">Array</a> of <code>id</code>s.</p>

<p>Note: Although it is often much faster than the alternative, <a
href="Relation.html#method-i-destroy">destroy</a>, skipping callbacks might
bypass business logic in your application that ensures referential
integrity or performs other essential jobs.</p>

<h4 id="method-i-delete-label-Examples">Examples<span><a href="#method-i-delete-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-comment"># Delete a single row</span>
<span class="ruby-constant">Todo</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">1</span>)

<span class="ruby-comment"># Delete multiple rows</span>
<span class="ruby-constant">Todo</span>.<span class="ruby-identifier">delete</span>([<span class="ruby-value">2</span>,<span class="ruby-value">3</span>,<span class="ruby-value">4</span>])
</pre>
          
          

          
          <div class="method-source-code" id="delete-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 535</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete</span>(<span class="ruby-identifier">id_or_array</span>)
  <span class="ruby-identifier">where</span>(<span class="ruby-identifier">primary_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">id_or_array</span>).<span class="ruby-identifier">delete_all</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-delete_all" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Deletes the records without instantiating the records first, and hence not
calling the <a href="Persistence.html#method-i-destroy">#destroy</a> method
nor invoking callbacks. This is a single SQL DELETE statement that goes
straight to the database, much more efficient than <a
href="Relation.html#method-i-destroy_all">destroy_all</a>. Be careful with
relations though, in particular <code>:dependent</code> rules defined on
associations are not honored. Returns the number of rows affected.</p>

<pre class="ruby"><span class="ruby-constant">Post</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">person_id</span><span class="ruby-operator">:</span> <span class="ruby-value">5</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">category</span><span class="ruby-operator">:</span> [<span class="ruby-string">&#39;Something&#39;</span>, <span class="ruby-string">&#39;Else&#39;</span>]).<span class="ruby-identifier">delete_all</span>
</pre>

<p>Both calls delete the affected posts all at once with a single DELETE
statement. If you need to destroy dependent associations or call your
<code>before_*</code> or <code>after_destroy</code> callbacks, use the <a
href="Relation.html#method-i-destroy_all">destroy_all</a> method instead.</p>

<p>If an invalid method is supplied, <a
href="Relation.html#method-i-delete_all">delete_all</a> raises an
ActiveRecordError:</p>

<pre class="ruby"><span class="ruby-constant">Post</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-value">100</span>).<span class="ruby-identifier">delete_all</span>
<span class="ruby-comment"># =&gt; ActiveRecord::ActiveRecordError: delete_all doesn&#39;t support limit</span>
</pre>
          
          

          
          <div class="method-source-code" id="delete_all-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 492</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_all</span>
  <span class="ruby-identifier">invalid_methods</span> = <span class="ruby-constant">INVALID_METHODS_FOR_DELETE_ALL</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">get_value</span>(<span class="ruby-identifier">method</span>)
    <span class="ruby-constant">SINGLE_VALUE_METHODS</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">any?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">invalid_methods</span>.<span class="ruby-identifier">any?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRecordError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;delete_all doesn&#39;t support #{invalid_methods.join(&#39;, &#39;)}&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">stmt</span> = <span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">DeleteManager</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">from</span>(<span class="ruby-identifier">table</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_join_values?</span>
    <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">join_to_delete</span>(<span class="ruby-identifier">stmt</span>, <span class="ruby-identifier">arel</span>, <span class="ruby-identifier">arel_attribute</span>(<span class="ruby-identifier">primary_key</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">wheres</span> = <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">constraints</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">affected</span> = <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">stmt</span>, <span class="ruby-string">&quot;SQL&quot;</span>, <span class="ruby-identifier">bound_attributes</span>)

  <span class="ruby-identifier">reset</span>
  <span class="ruby-identifier">affected</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">destroy</span><span
            class="method-args">(id)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Destroy an object (or multiple objects) that has the given id. The object
is instantiated first, therefore all callbacks and filters are fired off
before the object is deleted. This method is less efficient than <a
href="Relation.html#method-i-delete">delete</a> but allows cleanup methods
and other actions to be run.</p>

<p>This essentially finds the object (or multiple objects) with the given id,
creates a new object from the attributes, and then calls destroy on it.</p>

<h4 id="method-i-destroy-label-Parameters">Parameters<span><a href="#method-i-destroy-label-Parameters">&para;</a> <a href="#top">&uarr;</a></span></h4>
<ul><li>
<p><code>id</code> - Can be either an <a href="../Integer.html">Integer</a> or
an <a href="../Array.html">Array</a> of Integers.</p>
</li></ul>

<h4 id="method-i-destroy-label-Examples">Examples<span><a href="#method-i-destroy-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-comment"># Destroy a single object</span>
<span class="ruby-constant">Todo</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-value">1</span>)

<span class="ruby-comment"># Destroy multiple objects</span>
<span class="ruby-identifier">todos</span> = [<span class="ruby-value">1</span>,<span class="ruby-value">2</span>,<span class="ruby-value">3</span>]
<span class="ruby-constant">Todo</span>.<span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">todos</span>)
</pre>
          
          

          
          <div class="method-source-code" id="destroy-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 466</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">id</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
    <span class="ruby-identifier">id</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">one_id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">one_id</span>) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">find</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-destroy_all" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">destroy_all</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Destroys the records by instantiating each record and calling its <a
href="Persistence.html#method-i-destroy">#destroy</a> method. Each
object&#39;s callbacks are executed (including <code>:dependent</code>
association options). Returns the collection of objects that were
destroyed; each will be frozen, to reflect that no changes should be made
(since they can&#39;t be persisted).</p>

<p>Note: Instantiation, callback execution, and deletion of each record can be
time consuming when you&#39;re removing many records at once. It generates
at least one SQL <code>DELETE</code> query per record (or possibly more, to
enforce your callbacks). If you want to delete many rows quickly, without
concern for their associations or callbacks, use <a
href="Relation.html#method-i-delete_all">delete_all</a> instead.</p>

<h4 id="method-i-destroy_all-label-Examples">Examples<span><a href="#method-i-destroy_all-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-constant">Person</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">age</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">18</span>).<span class="ruby-identifier">destroy_all</span>
</pre>
          
          

          
          <div class="method-source-code" id="destroy_all-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 443</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy_all</span>
  <span class="ruby-identifier">records</span>.<span class="ruby-identifier">each</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:destroy</span>).<span class="ruby-identifier">tap</span> { <span class="ruby-identifier">reset</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-eager_loading-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">eager_loading?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if relation needs eager loading.</p>
          
          

          
          <div class="method-source-code" id="eager_loading-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 597</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">eager_loading?</span>
  <span class="ruby-ivar">@should_eager_load</span> <span class="ruby-operator">||=</span>
    <span class="ruby-identifier">eager_load_values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">||</span>
    <span class="ruby-identifier">includes_values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">joined_includes_values</span>.<span class="ruby-identifier">any?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">references_eager_loaded_tables?</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-empty-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">empty?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are no records.</p>
          
          

          
          <div class="method-source-code" id="empty-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">empty?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@records</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">loaded?</span>
  <span class="ruby-operator">!</span><span class="ruby-identifier">exists?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-encode_with" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">encode_with</span><span
            class="method-args">(coder)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Serializes the relation objects <a href="../Array.html">Array</a>.</p>
          
          

          
          <div class="method-source-code" id="encode_with-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 260</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">encode_with</span>(<span class="ruby-identifier">coder</span>)
  <span class="ruby-identifier">coder</span>.<span class="ruby-identifier">represent_seq</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">records</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-explain" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">explain</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Runs EXPLAIN on the query or queries triggered by this relation and returns
the result as a string. The string is formatted imitating the ones printed
by the database shell.</p>

<p>Note that this method actually runs the queries, since the results of some
are needed by the next ones when eager loading is going on.</p>

<p>Please see further details in the <a
href="http://guides.rubyonrails.org/active_record_querying.html#running-explain">Active
Record Query Interface guide</a>.</p>
          
          

          
          <div class="method-source-code" id="explain-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 245</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">explain</span>
  <span class="ruby-identifier">exec_explain</span>(<span class="ruby-identifier">collecting_queries_for_explain</span> { <span class="ruby-identifier">exec_queries</span> })
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-find_or_create_by" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_or_create_by</span><span
            class="method-args">(attributes, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Finds the first record with the given attributes, or creates a record with
the attributes if one is not found:</p>

<pre class="ruby"><span class="ruby-comment"># Find the first user named &quot;Penélope&quot; or create a new one.</span>
<span class="ruby-constant">User</span>.<span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">first_name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Penélope&#39;</span>)
<span class="ruby-comment"># =&gt; #&lt;User id: 1, first_name: &quot;Penélope&quot;, last_name: nil&gt;</span>

<span class="ruby-comment"># Find the first user named &quot;Penélope&quot; or create a new one.</span>
<span class="ruby-comment"># We already have one so the existing record will be returned.</span>
<span class="ruby-constant">User</span>.<span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">first_name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Penélope&#39;</span>)
<span class="ruby-comment"># =&gt; #&lt;User id: 1, first_name: &quot;Penélope&quot;, last_name: nil&gt;</span>

<span class="ruby-comment"># Find the first user named &quot;Scarlett&quot; or create a new one with</span>
<span class="ruby-comment"># a particular last name.</span>
<span class="ruby-constant">User</span>.<span class="ruby-identifier">create_with</span>(<span class="ruby-identifier">last_name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Johansson&#39;</span>).<span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">first_name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Scarlett&#39;</span>)
<span class="ruby-comment"># =&gt; #&lt;User id: 2, first_name: &quot;Scarlett&quot;, last_name: &quot;Johansson&quot;&gt;</span>
</pre>

<p>This method accepts a block, which is passed down to <a
href="Relation.html#method-i-create">create</a>. The last example above can
be alternatively written this way:</p>

<pre class="ruby"><span class="ruby-comment"># Find the first user named &quot;Scarlett&quot; or create a new one with a</span>
<span class="ruby-comment"># different last name.</span>
<span class="ruby-constant">User</span>.<span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">first_name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Scarlett&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">user</span>.<span class="ruby-identifier">last_name</span> = <span class="ruby-string">&#39;Johansson&#39;</span>
<span class="ruby-keyword">end</span>
<span class="ruby-comment"># =&gt; #&lt;User id: 2, first_name: &quot;Scarlett&quot;, last_name: &quot;Johansson&quot;&gt;</span>
</pre>

<p>This method always returns a record, but if creation was attempted and
failed due to validation errors it won&#39;t be persisted, you get what <a
href="Relation.html#method-i-create">create</a> returns in such situation.</p>

<p>Please note *this method is not atomic*, it runs first a SELECT, and if
there are no results an INSERT is attempted. If there are other threads or
processes there is a race condition between both calls and it could be the
case that you end up with two similar records.</p>

<p>Whether that is a problem or not depends on the logic of the application,
but in the particular case in which rows have a UNIQUE constraint an
exception may be raised, just retry:</p>

<pre class="ruby"><span class="ruby-keyword">begin</span>
  <span class="ruby-constant">CreditAccount</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">requires_new</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span>
    <span class="ruby-constant">CreditAccount</span>.<span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">user_id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">RecordNotUnique</span>
  <span class="ruby-keyword">retry</span>
<span class="ruby-keyword">end</span>
</pre>
          
          

          
          <div class="method-source-code" id="find_or_create_by-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 219</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_or_create_by</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">attributes</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-find_or_create_by-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_or_create_by!</span><span
            class="method-args">(attributes, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Like <a
href="Relation.html#method-i-find_or_create_by">find_or_create_by</a>, but
calls <a
href="Persistence/ClassMethods.html#method-i-create-21">create!</a> so an
exception is raised if the created record is invalid.</p>
          
          

          
          <div class="method-source-code" id="find_or_create_by-21-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 226</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_or_create_by!</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">attributes</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">create!</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-find_or_initialize_by" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_or_initialize_by</span><span
            class="method-args">(attributes, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Like <a
href="Relation.html#method-i-find_or_create_by">find_or_create_by</a>, but
calls new instead of <a
href="Persistence/ClassMethods.html#method-i-create">create</a>.</p>
          
          

          
          <div class="method-source-code" id="find_or_initialize_by-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 232</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_or_initialize_by</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">find_by</span>(<span class="ruby-identifier">attributes</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">new</span>(<span class="ruby-identifier">attributes</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-initialize_copy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_copy</span><span
            class="method-args">(other)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="initialize_copy-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_copy</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-ivar">@values</span> = <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">reset</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-inspect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inspect</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="inspect-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 636</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inspect</span>
  <span class="ruby-identifier">subject</span> = <span class="ruby-identifier">loaded?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">records</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>
  <span class="ruby-identifier">entries</span> = <span class="ruby-identifier">subject</span>.<span class="ruby-identifier">take</span>([<span class="ruby-identifier">limit_value</span>, <span class="ruby-value">11</span>].<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">min</span>).<span class="ruby-identifier">map!</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:inspect</span>)

  <span class="ruby-identifier">entries</span>[<span class="ruby-value">10</span>] = <span class="ruby-string">&quot;...&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">entries</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">11</span>

  <span class="ruby-node">&quot;#&lt;#{self.class.name} [#{entries.join(&#39;, &#39;)}]&gt;&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-joined_includes_values" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">joined_includes_values</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Joins that are also marked for preloading. In which case we should just
eager load them. Note that this is a naive implementation because we could
have strings and symbols which represent the same association, but that
aren&#39;t matched by this. Also, we could have nested hashes which
partially match, e.g. { a: :b } &amp; { a: [:b, :c] }</p>
          
          

          
          <div class="method-source-code" id="joined_includes_values-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 607</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">joined_includes_values</span>
  <span class="ruby-identifier">includes_values</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">joins_values</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-load" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load</span><span
            class="method-args">(&block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Causes the records to be loaded from the database if they have not been
loaded already. You can use this if for some reason you need to explicitly
load some records before actually using them. The return value is the
relation itself, not the records.</p>

<pre class="ruby"><span class="ruby-constant">Post</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">published</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>).<span class="ruby-identifier">load</span> <span class="ruby-comment"># =&gt; #&lt;ActiveRecord::Relation&gt;</span>
</pre>
          
          

          
          <div class="method-source-code" id="load-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 545</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">exec_queries</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">loaded?</span>

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-many-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">many?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there is more than one record.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              <a href="../Enumerable.html#method-i-many-3F">Enumerable#many?</a>
            </div>
          

          
          <div class="method-source-code" id="many-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 294</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">many?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">limit_value</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">records</span>.<span class="ruby-identifier">many?</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*args, &block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Initializes new record from relation while maintaining the current scope.</p>

<p>Expects arguments in the same format as <a
href="Core.html#method-c-new">ActiveRecord::Base.new</a>.</p>

<pre class="ruby"><span class="ruby-identifier">users</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;DHH&#39;</span>)
<span class="ruby-identifier">user</span> = <span class="ruby-identifier">users</span>.<span class="ruby-identifier">new</span> <span class="ruby-comment"># =&gt; #&lt;User id: nil, name: &quot;DHH&quot;, created_at: nil, updated_at: nil&gt;</span>
</pre>

<p>You can also pass a block to new with the new record as argument:</p>

<pre class="ruby"><span class="ruby-identifier">user</span> = <span class="ruby-identifier">users</span>.<span class="ruby-identifier">new</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">user</span><span class="ruby-operator">|</span> <span class="ruby-identifier">user</span>.<span class="ruby-identifier">name</span> = <span class="ruby-string">&#39;Oscar&#39;</span> }
<span class="ruby-identifier">user</span>.<span class="ruby-identifier">name</span> <span class="ruby-comment"># =&gt; Oscar</span>
</pre>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 120</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">scoping</span> { <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Relation.html#method-i-build">build</a>
        </div>
        

        
      </div>

    
      <div id="method-i-none-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">none?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there are no records.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="none-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 276</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">none?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-one-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">one?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns true if there is exactly one record.</p>
          
          
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
          

          
          <div class="method-source-code" id="one-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 288</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">one?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-identifier">limit_value</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">records</span>.<span class="ruby-identifier">one?</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-pretty_print" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pretty_print</span><span
            class="method-args">(q)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="pretty_print-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 623</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pretty_print</span>(<span class="ruby-identifier">q</span>)
  <span class="ruby-identifier">q</span>.<span class="ruby-identifier">pp</span>(<span class="ruby-identifier">records</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reload" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reload</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Forces reloading of relation.</p>
          
          

          
          <div class="method-source-code" id="reload-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 552</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reload</span>
  <span class="ruby-identifier">reset</span>
  <span class="ruby-identifier">load</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reset</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="reset-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 557</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reset</span>
  <span class="ruby-ivar">@last</span> = <span class="ruby-ivar">@to_sql</span> = <span class="ruby-ivar">@order_clause</span> = <span class="ruby-ivar">@scope_for_create</span> = <span class="ruby-ivar">@arel</span> = <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@should_eager_load</span> = <span class="ruby-ivar">@join_dependency</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@records</span> = [].<span class="ruby-identifier">freeze</span>
  <span class="ruby-ivar">@offsets</span> = {}
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-scope_for_create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">scope_for_create</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="scope_for_create-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 592</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">scope_for_create</span>
  <span class="ruby-ivar">@scope_for_create</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">where_values_hash</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">create_with_value</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-scoping" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">scoping</span><span
            class="method-args">() { || ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Scope all queries to the current scope.</p>

<pre class="ruby"><span class="ruby-constant">Comment</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">post_id</span><span class="ruby-operator">:</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">scoping</span> <span class="ruby-keyword">do</span>
  <span class="ruby-constant">Comment</span>.<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span>
<span class="ruby-comment"># =&gt; SELECT &quot;comments&quot;.* FROM &quot;comments&quot; WHERE &quot;comments&quot;.&quot;post_id&quot; = 1 ORDER BY &quot;comments&quot;.&quot;id&quot; ASC LIMIT 1</span>
</pre>

<p>Please check unscoped if you want to remove all previous scopes (including
the default_scope) during the execution of a block.</p>
          
          

          
          <div class="method-source-code" id="scoping-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 334</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">scoping</span>
  <span class="ruby-identifier">previous</span>, <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">current_scope</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">current_scope</span>(<span class="ruby-keyword">true</span>), <span class="ruby-keyword">self</span>
  <span class="ruby-keyword">yield</span>
<span class="ruby-keyword">ensure</span>
  <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">current_scope</span> = <span class="ruby-identifier">previous</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-size" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">size</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns size of the records.</p>
          
          

          
          <div class="method-source-code" id="size-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 265</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">size</span>
  <span class="ruby-identifier">loaded?</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@records</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">count</span>(<span class="ruby-value">:all</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_a" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_a</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Converts relation objects to <a href="../Array.html">Array</a>.</p>
          
          

          
          <div class="method-source-code" id="to_a-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 250</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_a</span>
  <span class="ruby-identifier">records</span>.<span class="ruby-identifier">dup</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-to_sql" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_sql</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns sql statement for the relation.</p>

<pre class="ruby"><span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Oscar&#39;</span>).<span class="ruby-identifier">to_sql</span>
<span class="ruby-comment"># =&gt; SELECT &quot;users&quot;.* FROM &quot;users&quot;  WHERE &quot;users&quot;.&quot;name&quot; = &#39;Oscar&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="to_sql-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 569</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_sql</span>
  <span class="ruby-ivar">@to_sql</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">begin</span>
                <span class="ruby-identifier">relation</span> = <span class="ruby-keyword">self</span>

                <span class="ruby-keyword">if</span> <span class="ruby-identifier">eager_loading?</span>
                  <span class="ruby-identifier">find_with_associations</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">rel</span>, <span class="ruby-identifier">_</span><span class="ruby-operator">|</span> <span class="ruby-identifier">relation</span> = <span class="ruby-identifier">rel</span> }
                <span class="ruby-keyword">end</span>

                <span class="ruby-identifier">conn</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">connection</span>
                <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">unprepared_statement</span> {
                  <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">to_sql</span>(<span class="ruby-identifier">relation</span>.<span class="ruby-identifier">arel</span>, <span class="ruby-identifier">relation</span>.<span class="ruby-identifier">bound_attributes</span>)
                }
              <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-update" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update</span><span
            class="method-args">(id = :all, attributes)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Updates an object (or multiple objects) and saves it to the database, if
validations pass. The resulting object is returned whether the object was
saved successfully to the database or not.</p>

<h4 id="method-i-update-label-Parameters">Parameters<span><a href="#method-i-update-label-Parameters">&para;</a> <a href="#top">&uarr;</a></span></h4>
<ul><li>
<p><code>id</code> - This should be the id or an array of ids to be updated.</p>
</li><li>
<p><code>attributes</code> - This should be a hash of attributes or an array
of hashes.</p>
</li></ul>

<h4 id="method-i-update-label-Examples">Examples<span><a href="#method-i-update-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-comment"># Updates one record</span>
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">update</span>(<span class="ruby-value">15</span>, <span class="ruby-identifier">user_name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Samuel&#39;</span>, <span class="ruby-identifier">group</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;expert&#39;</span>)

<span class="ruby-comment"># Updates multiple records</span>
<span class="ruby-identifier">people</span> = { <span class="ruby-value">1</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;David&quot;</span> }, <span class="ruby-value">2</span> =<span class="ruby-operator">&gt;</span> { <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Jeremy&quot;</span> } }
<span class="ruby-constant">Person</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">people</span>.<span class="ruby-identifier">keys</span>, <span class="ruby-identifier">people</span>.<span class="ruby-identifier">values</span>)

<span class="ruby-comment"># Updates multiple records from the result of a relation</span>
<span class="ruby-identifier">people</span> = <span class="ruby-constant">Person</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">group</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;expert&#39;</span>)
<span class="ruby-identifier">people</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">group</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;masters&#39;</span>)
</pre>

<p>Note: Updating a large number of records will run an UPDATE query for each
record, which may cause a performance issue. So if it is not needed to run
callbacks for each update, it is preferred to use <a
href="Relation.html#method-i-update_all">update_all</a> for updating all
records using a single query.</p>
          
          

          
          <div class="method-source-code" id="update-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 409</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">id</span> = <span class="ruby-value">:all</span>, <span class="ruby-identifier">attributes</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
        <span class="ruby-identifier">id</span>.<span class="ruby-identifier">map</span>.<span class="ruby-identifier">with_index</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">one_id</span>, <span class="ruby-identifier">idx</span><span class="ruby-operator">|</span> <span class="ruby-identifier">update</span>(<span class="ruby-identifier">one_id</span>, <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">idx</span>]) }
      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-value">:all</span>
        <span class="ruby-identifier">records</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">record</span><span class="ruby-operator">|</span> <span class="ruby-identifier">record</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attributes</span>) }
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">id</span>
          <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;            You are passing an instance of ActiveRecord::Base to `update`.
            Please pass the id of the object by calling `.id`.
&quot;</span>.<span class="ruby-identifier">squish</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">object</span> = <span class="ruby-identifier">find</span>(<span class="ruby-identifier">id</span>)
        <span class="ruby-identifier">object</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">attributes</span>)
        <span class="ruby-identifier">object</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-update_all" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_all</span><span
            class="method-args">(updates)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Updates all records in the current relation with details given. This method
constructs a single SQL UPDATE statement and sends it straight to the
database. It does not instantiate the involved models and it does not
trigger Active Record callbacks or validations. However, values passed to
<a href="Relation.html#method-i-update_all">update_all</a> will still go
through Active Record&#39;s normal type casting and serialization.</p>

<h4 id="method-i-update_all-label-Parameters">Parameters<span><a href="#method-i-update_all-label-Parameters">&para;</a> <a href="#top">&uarr;</a></span></h4>
<ul><li>
<p><code>updates</code> - A string, array, or hash representing the SET part
of an SQL statement.</p>
</li></ul>

<h4 id="method-i-update_all-label-Examples">Examples<span><a href="#method-i-update_all-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-comment"># Update all customers with the given attributes</span>
<span class="ruby-constant">Customer</span>.<span class="ruby-identifier">update_all</span> <span class="ruby-identifier">wants_email</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>

<span class="ruby-comment"># Update all books with &#39;Rails&#39; in their title</span>
<span class="ruby-constant">Book</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&#39;title LIKE ?&#39;</span>, <span class="ruby-string">&#39;%Rails%&#39;</span>).<span class="ruby-identifier">update_all</span>(<span class="ruby-identifier">author</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;David&#39;</span>)

<span class="ruby-comment"># Update all books that match conditions, but limit it to 5 ordered by date</span>
<span class="ruby-constant">Book</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&#39;title LIKE ?&#39;</span>, <span class="ruby-string">&#39;%Rails%&#39;</span>).<span class="ruby-identifier">order</span>(:<span class="ruby-identifier">created_at</span>).<span class="ruby-identifier">limit</span>(<span class="ruby-value">5</span>).<span class="ruby-identifier">update_all</span>(<span class="ruby-identifier">author</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;David&#39;</span>)

<span class="ruby-comment"># Update all invoices and set the number column to its id value.</span>
<span class="ruby-constant">Invoice</span>.<span class="ruby-identifier">update_all</span>(<span class="ruby-string">&#39;number = id&#39;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="update_all-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 363</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_all</span>(<span class="ruby-identifier">updates</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;Empty list of attributes to change&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">updates</span>.<span class="ruby-identifier">blank?</span>

  <span class="ruby-identifier">stmt</span> = <span class="ruby-constant">Arel</span><span class="ruby-operator">::</span><span class="ruby-constant">UpdateManager</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">set</span> <span class="ruby-constant">Arel</span>.<span class="ruby-identifier">sql</span>(<span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:sanitize_sql_for_assignment</span>, <span class="ruby-identifier">updates</span>))
  <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">table</span>(<span class="ruby-identifier">table</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">has_join_values?</span>
    <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">join_to_update</span>(<span class="ruby-identifier">stmt</span>, <span class="ruby-identifier">arel</span>, <span class="ruby-identifier">arel_attribute</span>(<span class="ruby-identifier">primary_key</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">key</span> = <span class="ruby-identifier">arel_attribute</span>(<span class="ruby-identifier">primary_key</span>)
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">take</span>(<span class="ruby-identifier">arel</span>.<span class="ruby-identifier">limit</span>)
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">order</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arel</span>.<span class="ruby-identifier">orders</span>)
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">wheres</span> = <span class="ruby-identifier">arel</span>.<span class="ruby-identifier">constraints</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@klass</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">update</span> <span class="ruby-identifier">stmt</span>, <span class="ruby-string">&quot;SQL&quot;</span>, <span class="ruby-identifier">bound_attributes</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-values" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">values</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="values-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 632</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">values</span>
  <span class="ruby-ivar">@values</span>.<span class="ruby-identifier">dup</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-where_values_hash" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">where_values_hash</span><span
            class="method-args">(relation_table_name = table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a hash of where conditions.</p>

<pre class="ruby"><span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;Oscar&#39;</span>).<span class="ruby-identifier">where_values_hash</span>
<span class="ruby-comment"># =&gt; {name: &quot;Oscar&quot;}</span>
</pre>
          
          

          
          <div class="method-source-code" id="where_values_hash-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 588</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">where_values_hash</span>(<span class="ruby-identifier">relation_table_name</span> = <span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">where_clause</span>.<span class="ruby-identifier">to_h</span>(<span class="ruby-identifier">relation_table_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Protected Instance Methods</h3>
       </header>

    
      <div id="method-i-load_records" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_records</span><span
            class="method-args">(records)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="load_records-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/relation.rb, line 655</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_records</span>(<span class="ruby-identifier">records</span>)
  <span class="ruby-ivar">@records</span> = <span class="ruby-identifier">records</span>.<span class="ruby-identifier">freeze</span>
  <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

