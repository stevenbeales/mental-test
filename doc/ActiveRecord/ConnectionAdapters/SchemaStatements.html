<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module ActiveRecord::ConnectionAdapters::SchemaStatements - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/jquery.js"></script>
<script src="../../js/darkfish.js"></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-add_belongs_to">#add_belongs_to</a>
    
    <li ><a href="#method-i-add_column">#add_column</a>
    
    <li ><a href="#method-i-add_foreign_key">#add_foreign_key</a>
    
    <li ><a href="#method-i-add_index">#add_index</a>
    
    <li ><a href="#method-i-add_reference">#add_reference</a>
    
    <li ><a href="#method-i-add_timestamps">#add_timestamps</a>
    
    <li ><a href="#method-i-assume_migrated_upto_version">#assume_migrated_upto_version</a>
    
    <li ><a href="#method-i-change_column">#change_column</a>
    
    <li ><a href="#method-i-change_column_default">#change_column_default</a>
    
    <li ><a href="#method-i-change_column_null">#change_column_null</a>
    
    <li ><a href="#method-i-change_table">#change_table</a>
    
    <li ><a href="#method-i-change_table_comment">#change_table_comment</a>
    
    <li ><a href="#method-i-column_exists-3F">#column_exists?</a>
    
    <li ><a href="#method-i-columns">#columns</a>
    
    <li ><a href="#method-i-create_join_table">#create_join_table</a>
    
    <li ><a href="#method-i-create_table">#create_table</a>
    
    <li ><a href="#method-i-data_source_exists-3F">#data_source_exists?</a>
    
    <li ><a href="#method-i-data_sources">#data_sources</a>
    
    <li ><a href="#method-i-drop_join_table">#drop_join_table</a>
    
    <li ><a href="#method-i-drop_table">#drop_table</a>
    
    <li ><a href="#method-i-foreign_key_exists-3F">#foreign_key_exists?</a>
    
    <li ><a href="#method-i-foreign_keys">#foreign_keys</a>
    
    <li ><a href="#method-i-index_exists-3F">#index_exists?</a>
    
    <li ><a href="#method-i-index_name_exists-3F">#index_name_exists?</a>
    
    <li ><a href="#method-i-indexes">#indexes</a>
    
    <li ><a href="#method-i-native_database_types">#native_database_types</a>
    
    <li ><a href="#method-i-options_include_default-3F">#options_include_default?</a>
    
    <li ><a href="#method-i-primary_key">#primary_key</a>
    
    <li ><a href="#method-i-remove_belongs_to">#remove_belongs_to</a>
    
    <li ><a href="#method-i-remove_column">#remove_column</a>
    
    <li ><a href="#method-i-remove_columns">#remove_columns</a>
    
    <li ><a href="#method-i-remove_foreign_key">#remove_foreign_key</a>
    
    <li ><a href="#method-i-remove_index">#remove_index</a>
    
    <li ><a href="#method-i-remove_reference">#remove_reference</a>
    
    <li ><a href="#method-i-remove_timestamps">#remove_timestamps</a>
    
    <li ><a href="#method-i-rename_column">#rename_column</a>
    
    <li ><a href="#method-i-rename_index">#rename_index</a>
    
    <li ><a href="#method-i-rename_table">#rename_table</a>
    
    <li ><a href="#method-i-table_alias_for">#table_alias_for</a>
    
    <li ><a href="#method-i-table_comment">#table_comment</a>
    
    <li ><a href="#method-i-table_exists-3F">#table_exists?</a>
    
    <li ><a href="#method-i-table_options">#table_options</a>
    
    <li ><a href="#method-i-tables">#tables</a>
    
    <li ><a href="#method-i-view_exists-3F">#view_exists?</a>
    
    <li ><a href="#method-i-views">#views</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-ActiveRecord::ConnectionAdapters::SchemaStatements">
  <h1 id="module-ActiveRecord::ConnectionAdapters::SchemaStatements" class="module">
    module ActiveRecord::ConnectionAdapters::SchemaStatements
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-add_belongs_to" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">add_belongs_to</span><span
            class="method-args">(table_name, ref_name, **options)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="SchemaStatements.html#method-i-add_reference">add_reference</a>
        </div>
        
      </div>

    
      <div id="method-i-add_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_column</span><span
            class="method-args">(table_name, column_name, type, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a new <code>type</code> column named <code>column_name</code> to
<code>table_name</code>.</p>

<p>The <code>type</code> parameter is normally one of the migrations native
types, which is one of the following: <code>:primary_key</code>,
<code>:string</code>, <code>:text</code>, <code>:integer</code>,
<code>:bigint</code>, <code>:float</code>, <code>:decimal</code>,
<code>:numeric</code>, <code>:datetime</code>, <code>:time</code>,
<code>:date</code>, <code>:binary</code>, <code>:boolean</code>.</p>

<p>You may use a type not in this list as long as it is supported by your
database (for example, “polygon” in <a href="MySQL.html">MySQL</a>), but
this will not be database agnostic and should usually be avoided.</p>

<p>Available options are (none of these exists by default):</p>
<ul><li>
<p><code>:limit</code> - Requests a maximum column length. This is the number
of characters for a <code>:string</code> column and number of bytes for
<code>:text</code>, <code>:binary</code> and <code>:integer</code> columns.</p>
</li><li>
<p><code>:default</code> - The column&#39;s default value. Use
<code>nil</code> for <code>NULL</code>.</p>
</li><li>
<p><code>:null</code> - Allows or disallows <code>NULL</code> values in the
column. This option could have been named <code>:null_allowed</code>.</p>
</li><li>
<p><code>:precision</code> - Specifies the precision for the
<code>:decimal</code> and <code>:numeric</code> columns.</p>
</li><li>
<p><code>:scale</code> - Specifies the scale for the <code>:decimal</code> and
<code>:numeric</code> columns.</p>
</li></ul>

<p>Note: The precision is the total number of significant digits, and the
scale is the number of digits that can be stored following the decimal
point. For example, the number 123.45 has a precision of 5 and a scale of
2. A decimal with a precision of 5 and a scale of 2 can range from -999.99
to 999.99.</p>

<p>Please be aware of different RDBMS implementations behavior with
<code>:decimal</code> columns:</p>
<ul><li>
<p>The SQL standard says the default scale should be 0, <code>:scale</code>
&lt;= <code>:precision</code>, and makes no comments about the requirements
of <code>:precision</code>.</p>
</li><li>
<p>MySQL: <code>:precision</code> [1..63], <code>:scale</code> [0..30].
Default is (10,0).</p>
</li><li>
<p>PostgreSQL: <code>:precision</code> [1..infinity], <code>:scale</code>
[0..infinity]. No default.</p>
</li><li>
<p>SQLite3: No restrictions on <code>:precision</code> and
<code>:scale</code>, but the maximum supported <code>:precision</code> is
16. No default.</p>
</li><li>
<p>Oracle: <code>:precision</code> [1..38], <code>:scale</code> [-84..127].
Default is (38,0).</p>
</li><li>
<p>DB2: <code>:precision</code> [1..63], <code>:scale</code> [0..62]. Default
unknown.</p>
</li><li>
<p>SqlServer: <code>:precision</code> [1..38], <code>:scale</code> [0..38].
Default (38,0).</p>
</li></ul>

<h2 id="method-i-add_column-label-Examples">Examples<span><a href="#method-i-add_column-label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">users</span>, :<span class="ruby-identifier">picture</span>, :<span class="ruby-identifier">binary</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>.<span class="ruby-identifier">megabytes</span>)
<span class="ruby-comment"># ALTER TABLE &quot;users&quot; ADD &quot;picture&quot; blob(2097152)</span>

<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">articles</span>, :<span class="ruby-identifier">status</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">20</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;draft&#39;</span>, <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
<span class="ruby-comment"># ALTER TABLE &quot;articles&quot; ADD &quot;status&quot; varchar(20) DEFAULT &#39;draft&#39; NOT NULL</span>

<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">answers</span>, :<span class="ruby-identifier">bill_gates_money</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">15</span>, <span class="ruby-identifier">scale</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
<span class="ruby-comment"># ALTER TABLE &quot;answers&quot; ADD &quot;bill_gates_money&quot; decimal(15,2)</span>

<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">measurements</span>, :<span class="ruby-identifier">sensor_reading</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>, <span class="ruby-identifier">scale</span><span class="ruby-operator">:</span> <span class="ruby-value">20</span>)
<span class="ruby-comment"># ALTER TABLE &quot;measurements&quot; ADD &quot;sensor_reading&quot; decimal(30,20)</span>

<span class="ruby-comment"># While :scale defaults to zero on most databases, it</span>
<span class="ruby-comment"># probably wouldn&#39;t hurt to include it.</span>
<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">measurements</span>, :<span class="ruby-identifier">huge_integer</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">30</span>)
<span class="ruby-comment"># ALTER TABLE &quot;measurements&quot; ADD &quot;huge_integer&quot; decimal(30)</span>

<span class="ruby-comment"># Defines a column that stores an array of a type.</span>
<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">users</span>, :<span class="ruby-identifier">skills</span>, :<span class="ruby-identifier">text</span>, <span class="ruby-identifier">array</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
<span class="ruby-comment"># ALTER TABLE &quot;users&quot; ADD &quot;skills&quot; text[]</span>

<span class="ruby-comment"># Defines a column with a database-specific type.</span>
<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">shapes</span>, :<span class="ruby-identifier">triangle</span>, <span class="ruby-string">&#39;polygon&#39;</span>)
<span class="ruby-comment"># ALTER TABLE &quot;shapes&quot; ADD &quot;triangle&quot; polygon</span>
</pre>
          
          

          
          <div class="method-source-code" id="add_column-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 551</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">at</span> = <span class="ruby-identifier">create_alter_table</span> <span class="ruby-identifier">table_name</span>
  <span class="ruby-identifier">at</span>.<span class="ruby-identifier">add_column</span>(<span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">execute</span> <span class="ruby-identifier">schema_creation</span>.<span class="ruby-identifier">accept</span> <span class="ruby-identifier">at</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_foreign_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_foreign_key</span><span
            class="method-args">(from_table, to_table, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a new foreign key. <code>from_table</code> is the table with the key
column, <code>to_table</code> contains the referenced primary key.</p>

<p>The foreign key will be named after the following pattern:
<code>fk_rails_&lt;identifier&gt;</code>. <code>identifier</code> is a 10
character long string which is deterministically generated from the
<code>from_table</code> and <code>column</code>. A custom name can be
specified with the <code>:name</code> option.</p>

<h6 id="method-i-add_foreign_key-label-Creating+a+simple+foreign+key">Creating a simple foreign key<span><a href="#method-i-add_foreign_key-label-Creating+a+simple+foreign+key">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_foreign_key</span> :<span class="ruby-identifier">articles</span>, :<span class="ruby-identifier">authors</span>
</pre>

<p>generates:</p>

<pre>ALTER TABLE &quot;articles&quot; ADD CONSTRAINT fk_rails_e74ce85cbc FOREIGN KEY (&quot;author_id&quot;) REFERENCES &quot;authors&quot; (&quot;id&quot;)</pre>

<h6 id="method-i-add_foreign_key-label-Creating+a+foreign+key+on+a+specific+column">Creating a foreign key on a specific column<span><a href="#method-i-add_foreign_key-label-Creating+a+foreign+key+on+a+specific+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_foreign_key</span> :<span class="ruby-identifier">articles</span>, :<span class="ruby-identifier">users</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">author_id</span>, <span class="ruby-identifier">primary_key</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;lng_id&quot;</span>
</pre>

<p>generates:</p>

<pre>ALTER TABLE &quot;articles&quot; ADD CONSTRAINT fk_rails_58ca3d3a82 FOREIGN KEY (&quot;author_id&quot;) REFERENCES &quot;users&quot; (&quot;lng_id&quot;)</pre>

<h6 id="method-i-add_foreign_key-label-Creating+a+cascading+foreign+key">Creating a cascading foreign key<span><a href="#method-i-add_foreign_key-label-Creating+a+cascading+foreign+key">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_foreign_key</span> :<span class="ruby-identifier">articles</span>, :<span class="ruby-identifier">authors</span>, <span class="ruby-identifier">on_delete</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">cascade</span>
</pre>

<p>generates:</p>

<pre>ALTER TABLE &quot;articles&quot; ADD CONSTRAINT fk_rails_e74ce85cbc FOREIGN KEY (&quot;author_id&quot;) REFERENCES &quot;authors&quot; (&quot;id&quot;) ON DELETE CASCADE</pre>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:column</code>
<dd>
<p>The foreign key column name on <code>from_table</code>. Defaults to
<code>to_table.singularize + &quot;_id&quot;</code></p>
</dd><dt><code>:primary_key</code>
<dd>
<p>The primary key column name on <code>to_table</code>. Defaults to
<code>id</code>.</p>
</dd><dt><code>:name</code>
<dd>
<p>The constraint name. Defaults to <code>fk_rails_&lt;identifier&gt;</code>.</p>
</dd><dt><code>:on_delete</code>
<dd>
<p>Action that happens <code>ON DELETE</code>. Valid values are
<code>:nullify</code>, <code>:cascade</code> and <code>:restrict</code></p>
</dd><dt><code>:on_update</code>
<dd>
<p>Action that happens <code>ON UPDATE</code>. Valid values are
<code>:nullify</code>, <code>:cascade</code> and <code>:restrict</code></p>
</dd></dl>
          
          

          
          <div class="method-source-code" id="add_foreign_key-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 923</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_foreign_key</span>(<span class="ruby-identifier">from_table</span>, <span class="ruby-identifier">to_table</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_foreign_keys?</span>

  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">foreign_key_options</span>(<span class="ruby-identifier">from_table</span>, <span class="ruby-identifier">to_table</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">at</span> = <span class="ruby-identifier">create_alter_table</span> <span class="ruby-identifier">from_table</span>
  <span class="ruby-identifier">at</span>.<span class="ruby-identifier">add_foreign_key</span> <span class="ruby-identifier">to_table</span>, <span class="ruby-identifier">options</span>

  <span class="ruby-identifier">execute</span> <span class="ruby-identifier">schema_creation</span>.<span class="ruby-identifier">accept</span>(<span class="ruby-identifier">at</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_index</span><span
            class="method-args">(table_name, column_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a new index to the table. <code>column_name</code> can be a single <a
href="../../Symbol.html">Symbol</a>, or an <a
href="../../Array.html">Array</a> of Symbols.</p>

<p>The index will be named after the table and the column name(s), unless you
pass <code>:name</code> as an option.</p>

<h6 id="method-i-add_index-label-Creating+a+simple+index">Creating a simple index<span><a href="#method-i-add_index-label-Creating+a+simple+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>)
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">suppliers_name_index</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">suppliers</span>(<span class="ruby-identifier">name</span>)
</pre>

<h6 id="method-i-add_index-label-Creating+a+unique+index">Creating a unique index<span><a href="#method-i-add_index-label-Creating+a+unique+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">accounts</span>, [:<span class="ruby-identifier">branch_id</span>, :<span class="ruby-identifier">party_id</span>], <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">UNIQUE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">accounts_branch_id_party_id_index</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">branch_id</span>, <span class="ruby-identifier">party_id</span>)
</pre>

<h6 id="method-i-add_index-label-Creating+a+named+index">Creating a named index<span><a href="#method-i-add_index-label-Creating+a+named+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">accounts</span>, [:<span class="ruby-identifier">branch_id</span>, :<span class="ruby-identifier">party_id</span>], <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;by_branch_party&#39;</span>)
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">UNIQUE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">by_branch_party</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">branch_id</span>, <span class="ruby-identifier">party_id</span>)
</pre>

<h6 id="method-i-add_index-label-Creating+an+index+with+specific+key+length">Creating an index with specific key length<span><a href="#method-i-add_index-label-Creating+an+index+with+specific+key+length">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">accounts</span>, :<span class="ruby-identifier">name</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;by_name&#39;</span>, <span class="ruby-identifier">length</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>)
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">by_name</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">name</span>(<span class="ruby-value">10</span>))
</pre>

<h6 id="method-i-add_index-label-Creating+an+index+with+specific+key+lengths+for+multiple+keys">Creating an index with specific key lengths for multiple keys<span><a href="#method-i-add_index-label-Creating+an+index+with+specific+key+lengths+for+multiple+keys">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">accounts</span>, [:<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">surname</span>], <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;by_name_surname&#39;</span>, <span class="ruby-identifier">length</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-value">10</span>, <span class="ruby-identifier">surname</span><span class="ruby-operator">:</span> <span class="ruby-value">15</span>})
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">by_name_surname</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">accounts</span>(<span class="ruby-identifier">name</span>(<span class="ruby-value">10</span>), <span class="ruby-identifier">surname</span>(<span class="ruby-value">15</span>))
</pre>

<p>Note: SQLite doesn&#39;t support index length.</p>

<h6 id="method-i-add_index-label-Creating+an+index+with+a+sort+order+-28desc+or+asc-2C+asc+is+the+default-29">Creating an index with a sort order (desc or asc, asc is the default)<span><a href="#method-i-add_index-label-Creating+an+index+with+a+sort+order+-28desc+or+asc-2C+asc+is+the+default-29">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">accounts</span>, [:<span class="ruby-identifier">branch_id</span>, :<span class="ruby-identifier">party_id</span>, :<span class="ruby-identifier">surname</span>], <span class="ruby-identifier">order</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">branch_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">desc</span>, <span class="ruby-identifier">party_id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">asc</span>})
</pre>

<p>generates:</p>

<pre>CREATE INDEX by_branch_desc_party ON accounts(branch_id DESC, party_id ASC, surname)</pre>

<p>Note: <a href="MySQL.html">MySQL</a> doesn&#39;t yet support index order
(it accepts the syntax but ignores it).</p>

<h6 id="method-i-add_index-label-Creating+a+partial+index">Creating a partial index<span><a href="#method-i-add_index-label-Creating+a+partial+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">accounts</span>, [:<span class="ruby-identifier">branch_id</span>, :<span class="ruby-identifier">party_id</span>], <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">where</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;active&quot;</span>)
</pre>

<p>generates:</p>

<pre>CREATE UNIQUE INDEX index_accounts_on_branch_id_and_party_id ON accounts(branch_id, party_id) WHERE active</pre>

<p>Note: Partial indexes are only supported for <a
href="PostgreSQL.html">PostgreSQL</a> and SQLite 3.8.0+.</p>

<h6 id="method-i-add_index-label-Creating+an+index+with+a+specific+method">Creating an index with a specific method<span><a href="#method-i-add_index-label-Creating+an+index+with+a+specific+method">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">developers</span>, :<span class="ruby-identifier">name</span>, <span class="ruby-identifier">using</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;btree&#39;</span>)
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">index_developers_on_name</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">developers</span> <span class="ruby-constant">USING</span> <span class="ruby-identifier">btree</span> (<span class="ruby-identifier">name</span>) <span class="ruby-operator">-</span><span class="ruby-operator">-</span> <span class="ruby-constant">PostgreSQL</span>
<span class="ruby-constant">CREATE</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">index_developers_on_name</span> <span class="ruby-constant">USING</span> <span class="ruby-identifier">btree</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">developers</span> (<span class="ruby-identifier">name</span>) <span class="ruby-operator">-</span><span class="ruby-operator">-</span> <span class="ruby-constant">MySQL</span>
</pre>

<p>Note: only supported by <a href="PostgreSQL.html">PostgreSQL</a> and <a
href="MySQL.html">MySQL</a></p>

<h6 id="method-i-add_index-label-Creating+an+index+with+a+specific+type">Creating an index with a specific type<span><a href="#method-i-add_index-label-Creating+an+index+with+a+specific+type">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_index</span>(:<span class="ruby-identifier">developers</span>, :<span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">fulltext</span>)
</pre>

<p>generates:</p>

<pre class="ruby"><span class="ruby-constant">CREATE</span> <span class="ruby-constant">FULLTEXT</span> <span class="ruby-constant">INDEX</span> <span class="ruby-identifier">index_developers_on_name</span> <span class="ruby-constant">ON</span> <span class="ruby-identifier">developers</span> (<span class="ruby-identifier">name</span>) <span class="ruby-operator">-</span><span class="ruby-operator">-</span> <span class="ruby-constant">MySQL</span>
</pre>

<p>Note: only supported by <a href="MySQL.html">MySQL</a>.</p>
          
          

          
          <div class="method-source-code" id="add_index-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 723</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">index_name</span>, <span class="ruby-identifier">index_type</span>, <span class="ruby-identifier">index_columns</span>, <span class="ruby-identifier">index_options</span> = <span class="ruby-identifier">add_index_options</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;CREATE #{index_type} INDEX #{quote_column_name(index_name)} ON #{quote_table_name(table_name)} (#{index_columns})#{index_options}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_reference" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_reference</span><span
            class="method-args">(table_name, ref_name, **options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds a reference. The reference column is an integer by default, the
<code>:type</code> option can be used to specify a different type.
Optionally adds a <code>_type</code> column, if <code>:polymorphic</code>
option is provided. <a
href="SchemaStatements.html#method-i-add_reference">add_reference</a> and
<a href="SchemaStatements.html#method-i-add_belongs_to">add_belongs_to</a>
are acceptable.</p>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:type</code>
<dd>
<p>The reference column type. Defaults to <code>:integer</code>.</p>
</dd><dt><code>:index</code>
<dd>
<p>Add an appropriate index. Defaults to true. See <a
href="SchemaStatements.html#method-i-add_index">add_index</a> for usage of
this option.</p>
</dd><dt><code>:foreign_key</code>
<dd>
<p>Add an appropriate foreign key constraint. Defaults to false.</p>
</dd><dt><code>:polymorphic</code>
<dd>
<p>Whether an additional <code>_type</code> column should be added. Defaults
to false.</p>
</dd><dt><code>:null</code>
<dd>
<p>Whether the column allows nulls. Defaults to true.</p>
</dd></dl>

<h6 id="method-i-add_reference-label-Create+a+user_id+integer+column">Create a user_id integer column<span><a href="#method-i-add_reference-label-Create+a+user_id+integer+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">user</span>)
</pre>

<h6 id="method-i-add_reference-label-Create+a+user_id+string+column">Create a user_id string column<span><a href="#method-i-add_reference-label-Create+a+user_id+string+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">user</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">string</span>)
</pre>

<h6 id="method-i-add_reference-label-Create+supplier_id-2C+supplier_type+columns+and+appropriate+index">Create supplier_id, supplier_type columns and appropriate index<span><a href="#method-i-add_reference-label-Create+supplier_id-2C+supplier_type+columns+and+appropriate+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>

<h6 id="method-i-add_reference-label-Create+a+supplier_id+column+with+a+unique+index">Create a supplier_id column with a unique index<span><a href="#method-i-add_reference-label-Create+a+supplier_id+column+with+a+unique+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span> })
</pre>

<h6 id="method-i-add_reference-label-Create+a+supplier_id+column+with+a+named+index">Create a supplier_id column with a named index<span><a href="#method-i-add_reference-label-Create+a+supplier_id+column+with+a+named+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> { <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;my_supplier_index&quot;</span> })
</pre>

<h6 id="method-i-add_reference-label-Create+a+supplier_id+column+and+appropriate+foreign+key">Create a supplier_id column and appropriate foreign key<span><a href="#method-i-add_reference-label-Create+a+supplier_id+column+and+appropriate+foreign+key">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">foreign_key</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>

<h6 id="method-i-add_reference-label-Create+a+supplier_id+column+and+a+foreign+key+to+the+firms+table">Create a supplier_id column and a foreign key to the firms table<span><a href="#method-i-add_reference-label-Create+a+supplier_id+column+and+a+foreign+key+to+the+firms+table">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">add_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">foreign_key</span><span class="ruby-operator">:</span> {<span class="ruby-identifier">to_table</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">firms</span>})
</pre>
          
          

          
          <div class="method-source-code" id="add_reference-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 838</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_reference</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">ref_name</span>, <span class="ruby-operator">**</span><span class="ruby-identifier">options</span>)
  <span class="ruby-constant">ReferenceDefinition</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">ref_name</span>, <span class="ruby-identifier">options</span>).<span class="ruby-identifier">add_to</span>(<span class="ruby-identifier">update_table_definition</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-keyword">self</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="SchemaStatements.html#method-i-add_belongs_to">add_belongs_to</a>
        </div>
        

        
      </div>

    
      <div id="method-i-add_timestamps" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_timestamps</span><span
            class="method-args">(table_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds timestamps (<code>created_at</code> and <code>updated_at</code>)
columns to <code>table_name</code>. Additional options (like
<code>:null</code>) are forwarded to <a
href="SchemaStatements.html#method-i-add_column">add_column</a>.</p>

<pre class="ruby"><span class="ruby-identifier">add_timestamps</span>(:<span class="ruby-identifier">suppliers</span>, <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>
          
          

          
          <div class="method-source-code" id="add_timestamps-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 1111</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_timestamps</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:null</span>] = <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:null</span>].<span class="ruby-identifier">nil?</span>

  <span class="ruby-identifier">add_column</span> <span class="ruby-identifier">table_name</span>, <span class="ruby-value">:created_at</span>, <span class="ruby-value">:datetime</span>, <span class="ruby-identifier">options</span>
  <span class="ruby-identifier">add_column</span> <span class="ruby-identifier">table_name</span>, <span class="ruby-value">:updated_at</span>, <span class="ruby-value">:datetime</span>, <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-assume_migrated_upto_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">assume_migrated_upto_version</span><span
            class="method-args">(version, migrations_paths)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="assume_migrated_upto_version-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 1033</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">assume_migrated_upto_version</span>(<span class="ruby-identifier">version</span>, <span class="ruby-identifier">migrations_paths</span>)
  <span class="ruby-identifier">migrations_paths</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">migrations_paths</span>)
  <span class="ruby-identifier">version</span> = <span class="ruby-identifier">version</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-identifier">sm_table</span> = <span class="ruby-identifier">quote_table_name</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">table_name</span>)

  <span class="ruby-identifier">migrated</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">SchemaMigration</span>.<span class="ruby-identifier">all_versions</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_i</span>)
  <span class="ruby-identifier">versions</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">migration_files</span>(<span class="ruby-identifier">migrations_paths</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migrator</span>.<span class="ruby-identifier">parse_migration_filename</span>(<span class="ruby-identifier">file</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">migrated</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">version</span>)
    <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;INSERT INTO #{sm_table} (version) VALUES (#{quote(version)})&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">inserting</span> = (<span class="ruby-identifier">versions</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">migrated</span>).<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">version</span> }
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">inserting</span>.<span class="ruby-identifier">any?</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">duplicate</span> = <span class="ruby-identifier">inserting</span>.<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">inserting</span>.<span class="ruby-identifier">count</span>(<span class="ruby-identifier">v</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> })
      <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Duplicate migration #{duplicate}. Please renumber your migrations to resolve the conflict.&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_multi_insert?</span>
      <span class="ruby-identifier">execute</span> <span class="ruby-identifier">insert_versions_sql</span>(<span class="ruby-identifier">inserting</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">inserting</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">execute</span> <span class="ruby-identifier">insert_versions_sql</span>(<span class="ruby-identifier">v</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_column</span><span
            class="method-args">(table_name, column_name, type, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Changes the column&#39;s definition according to the new options. See <a
href="TableDefinition.html#method-i-column">ActiveRecord::ConnectionAdapters::TableDefinition#column</a>
for details of the options you can use.</p>

<pre class="ruby"><span class="ruby-identifier">change_column</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">80</span>)
<span class="ruby-identifier">change_column</span>(:<span class="ruby-identifier">accounts</span>, :<span class="ruby-identifier">description</span>, :<span class="ruby-identifier">text</span>)
</pre>
          
          

          
          <div class="method-source-code" id="change_column-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 585</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;change_column is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_column_default" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_column_default</span><span
            class="method-args">(table_name, column_name, default_or_changes)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets a new default value for a column:</p>

<pre class="ruby"><span class="ruby-identifier">change_column_default</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">qualification</span>, <span class="ruby-string">&#39;new&#39;</span>)
<span class="ruby-identifier">change_column_default</span>(:<span class="ruby-identifier">accounts</span>, :<span class="ruby-identifier">authorized</span>, <span class="ruby-value">1</span>)
</pre>

<p>Setting the default to <code>nil</code> effectively drops the default:</p>

<pre class="ruby"><span class="ruby-identifier">change_column_default</span>(:<span class="ruby-identifier">users</span>, :<span class="ruby-identifier">email</span>, <span class="ruby-keyword">nil</span>)
</pre>

<p>Passing a hash containing <code>:from</code> and <code>:to</code> will make
this change reversible in migration:</p>

<pre class="ruby"><span class="ruby-identifier">change_column_default</span>(:<span class="ruby-identifier">posts</span>, :<span class="ruby-identifier">state</span>, <span class="ruby-identifier">from</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">to</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;draft&quot;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="change_column_default-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 603</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_column_default</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">default_or_changes</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;change_column_default is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_column_null" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_column_null</span><span
            class="method-args">(table_name, column_name, null, default = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Sets or removes a <code>NOT NULL</code> constraint on a column. The
<code>null</code> flag indicates whether the value can be
<code>NULL</code>. For example</p>

<pre class="ruby"><span class="ruby-identifier">change_column_null</span>(:<span class="ruby-identifier">users</span>, :<span class="ruby-identifier">nickname</span>, <span class="ruby-keyword">false</span>)
</pre>

<p>says nicknames cannot be <code>NULL</code> (adds the constraint), whereas</p>

<pre class="ruby"><span class="ruby-identifier">change_column_null</span>(:<span class="ruby-identifier">users</span>, :<span class="ruby-identifier">nickname</span>, <span class="ruby-keyword">true</span>)
</pre>

<p>allows them to be <code>NULL</code> (drops the constraint).</p>

<p>The method accepts an optional fourth argument to replace existing
<code>NULL</code>s with some other value. Use that one when enabling the
constraint if needed, since otherwise those rows would not be valid.</p>

<p>Please note the fourth argument does not set a column&#39;s default.</p>
          
          

          
          <div class="method-source-code" id="change_column_null-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 623</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_column_null</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">null</span>, <span class="ruby-identifier">default</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;change_column_null is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_table</span><span
            class="method-args">(table_name, options = {}) { |update_table_definition(table_name, recorder)| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A block for changing columns in <code>table</code>.</p>

<pre class="ruby"><span class="ruby-comment"># change_table() yields a Table instance</span>
<span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>
  <span class="ruby-comment"># Other column alterations here</span>
<span class="ruby-keyword">end</span>
</pre>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:bulk</code>
<dd>
<p>Set this to true to make this a bulk alter query, such as</p>

<pre>ALTER TABLE `users` ADD COLUMN age INT, ADD COLUMN birthdate DATETIME ...</pre>

<p>Defaults to false.</p>
</dd></dl>

<h6 id="method-i-change_table-label-Add+a+column">Add a column<span><a href="#method-i-change_table-label-Add+a+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>
<span class="ruby-keyword">end</span>
</pre>

<h6 id="method-i-change_table-label-Add+2+integer+columns">Add 2 integer columns<span><a href="#method-i-change_table-label-Add+2+integer+columns">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">integer</span> :<span class="ruby-identifier">width</span>, :<span class="ruby-identifier">height</span>, <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span>
</pre>

<h6 id="method-i-change_table-label-Add+created_at-2Fupdated_at+columns">Add created_at/updated_at columns<span><a href="#method-i-change_table-label-Add+created_at-2Fupdated_at+columns">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">timestamps</span>
<span class="ruby-keyword">end</span>
</pre>

<h6 id="method-i-change_table-label-Add+a+foreign+key+column">Add a foreign key column<span><a href="#method-i-change_table-label-Add+a+foreign+key+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">references</span> :<span class="ruby-identifier">company</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Creates a <code>company_id(integer)</code> column.</p>

<h6 id="method-i-change_table-label-Add+a+polymorphic+foreign+key+column">Add a polymorphic foreign key column<span><a href="#method-i-change_table-label-Add+a+polymorphic+foreign+key+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">belongs_to</span> :<span class="ruby-identifier">company</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Creates <code>company_type(varchar)</code> and
<code>company_id(integer)</code> columns.</p>

<h6 id="method-i-change_table-label-Remove+a+column">Remove a column<span><a href="#method-i-change_table-label-Remove+a+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">remove</span> :<span class="ruby-identifier">company</span>
<span class="ruby-keyword">end</span>
</pre>

<h6 id="method-i-change_table-label-Remove+several+columns">Remove several columns<span><a href="#method-i-change_table-label-Remove+several+columns">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">remove</span> :<span class="ruby-identifier">company_id</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">remove</span> :<span class="ruby-identifier">width</span>, :<span class="ruby-identifier">height</span>
<span class="ruby-keyword">end</span>
</pre>

<h6 id="method-i-change_table-label-Remove+an+index">Remove an index<span><a href="#method-i-change_table-label-Remove+an+index">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">change_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">remove_index</span> :<span class="ruby-identifier">company_id</span>
<span class="ruby-keyword">end</span>
</pre>

<p>See also <a href="Table.html">Table</a> for details on all of the various
column transformations.</p>
          
          

          
          <div class="method-source-code" id="change_table-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 440</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_bulk_alter?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:bulk</span>]
    <span class="ruby-identifier">recorder</span> = <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Migration</span><span class="ruby-operator">::</span><span class="ruby-constant">CommandRecorder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">update_table_definition</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">recorder</span>)
    <span class="ruby-identifier">bulk_change_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">recorder</span>.<span class="ruby-identifier">commands</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">update_table_definition</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-keyword">self</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-change_table_comment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">change_table_comment</span><span
            class="method-args">(table_name, comment)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Changes the comment for a table or removes it if <code>nil</code>.</p>
          
          

          
          <div class="method-source-code" id="change_table_comment-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 1168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">change_table_comment</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">comment</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;#{self.class} does not support changing table comments&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-column_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_exists?</span><span
            class="method-args">(table_name, column_name, type = nil, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if a column exists in a given table.</p>

<pre class="ruby"><span class="ruby-comment"># Check a column exists</span>
<span class="ruby-identifier">column_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>)

<span class="ruby-comment"># Check a column exists of a particular type</span>
<span class="ruby-identifier">column_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>)

<span class="ruby-comment"># Check a column exists with a specific definition</span>
<span class="ruby-identifier">column_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">100</span>)
<span class="ruby-identifier">column_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">default</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;default&#39;</span>)
<span class="ruby-identifier">column_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
<span class="ruby-identifier">column_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">tax</span>, :<span class="ruby-identifier">decimal</span>, <span class="ruby-identifier">precision</span><span class="ruby-operator">:</span> <span class="ruby-value">8</span>, <span class="ruby-identifier">scale</span><span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
</pre>
          
          

          
          <div class="method-source-code" id="column_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 128</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_exists?</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">type</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">column_name</span> = <span class="ruby-identifier">column_name</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">checks</span> = []
  <span class="ruby-identifier">checks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">column_name</span> }
  <span class="ruby-identifier">checks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">type</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span>
  <span class="ruby-identifier">column_options_keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">checks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">attr</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">attr</span>] } <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-identifier">attr</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">columns</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">checks</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">check</span><span class="ruby-operator">|</span> <span class="ruby-identifier">check</span>[<span class="ruby-identifier">c</span>] } }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-columns" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">columns</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of Column objects for the table specified by
<code>table_name</code>. See the concrete implementation for details on the
expected parameter values.</p>
          
          

          
          <div class="method-source-code" id="columns-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">columns</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;#columns is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-create_join_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_join_table</span><span
            class="method-args">(table_1, table_2, column_options: {}, **options) { |td| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new join table with the name created using the lexical order of
the first two arguments. These arguments can be a <a
href="../../String.html">String</a> or a <a
href="../../Symbol.html">Symbol</a>.</p>

<pre class="ruby"><span class="ruby-comment"># Creates a table called &#39;assemblies_parts&#39; with no id.</span>
<span class="ruby-identifier">create_join_table</span>(:<span class="ruby-identifier">assemblies</span>, :<span class="ruby-identifier">parts</span>)
</pre>

<p>You can pass an <code>options</code> hash which can include the following
keys:</p>
<dl class="rdoc-list label-list"><dt><code>:table_name</code>
<dd>
<p>Sets the table name, overriding the default.</p>
</dd><dt><code>:column_options</code>
<dd>
<p>Any extra options you want appended to the columns definition.</p>
</dd><dt><code>:options</code>
<dd>
<p>Any extra options you want appended to the table definition.</p>
</dd><dt><code>:temporary</code>
<dd>
<p>Make a temporary table.</p>
</dd><dt><code>:force</code>
<dd>
<p>Set to true to drop the table before creating it. Defaults to false.</p>
</dd></dl>

<p>Note that <a
href="SchemaStatements.html#method-i-create_join_table">create_join_table</a>
does not create any indices by default; you can use its block form to do so
yourself:</p>

<pre class="ruby"><span class="ruby-identifier">create_join_table</span> :<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">categories</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">index</span> :<span class="ruby-identifier">product_id</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">index</span> :<span class="ruby-identifier">category_id</span>
<span class="ruby-keyword">end</span>
</pre>

<h6 id="method-i-create_join_table-label-Add+a+backend+specific+option+to+the+generated+SQL+-28MySQL-29">Add a backend specific option to the generated SQL (MySQL)<span><a href="#method-i-create_join_table-label-Add+a+backend+specific+option+to+the+generated+SQL+-28MySQL-29">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">create_join_table</span>(:<span class="ruby-identifier">assemblies</span>, :<span class="ruby-identifier">parts</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;ENGINE=InnoDB DEFAULT CHARSET=utf8&#39;</span>)
</pre>

<p>generates:</p>

<pre>CREATE TABLE assemblies_parts (
  assembly_id int NOT NULL,
  part_id int NOT NULL,
) ENGINE=InnoDB DEFAULT CHARSET=utf8</pre>
          
          

          
          <div class="method-source-code" id="create_join_table-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 345</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_join_table</span>(<span class="ruby-identifier">table_1</span>, <span class="ruby-identifier">table_2</span>, <span class="ruby-identifier">column_options</span><span class="ruby-operator">:</span> {}, <span class="ruby-operator">**</span><span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">join_table_name</span> = <span class="ruby-identifier">find_join_table_name</span>(<span class="ruby-identifier">table_1</span>, <span class="ruby-identifier">table_2</span>, <span class="ruby-identifier">options</span>)

  <span class="ruby-identifier">column_options</span>.<span class="ruby-identifier">reverse_merge!</span>(<span class="ruby-identifier">null</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)

  <span class="ruby-identifier">t1_ref</span>, <span class="ruby-identifier">t2_ref</span> = [<span class="ruby-identifier">table_1</span>, <span class="ruby-identifier">table_2</span>].<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">singularize</span> }

  <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">join_table_name</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">td</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">td</span>.<span class="ruby-identifier">references</span> <span class="ruby-identifier">t1_ref</span>, <span class="ruby-identifier">column_options</span>
    <span class="ruby-identifier">td</span>.<span class="ruby-identifier">references</span> <span class="ruby-identifier">t2_ref</span>, <span class="ruby-identifier">column_options</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">td</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-create_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create_table</span><span
            class="method-args">(table_name, comment: nil, **options) { |td| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new table with the name <code>table_name</code>.
<code>table_name</code> may either be a <a
href="../../String.html">String</a> or a <a
href="../../Symbol.html">Symbol</a>.</p>

<p>There are two ways to work with <a
href="SchemaStatements.html#method-i-create_table">create_table</a>. You
can use the block form or the regular form, like this:</p>

<h3 id="method-i-create_table-label-Block+form">Block form<span><a href="#method-i-create_table-label-Block+form">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-comment"># create_table() passes a TableDefinition object to the block.</span>
<span class="ruby-comment"># This form will not only create the table, but also columns for the</span>
<span class="ruby-comment"># table.</span>

<span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>
  <span class="ruby-comment"># Other fields here</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="method-i-create_table-label-Block+form-2C+with+shorthand">Block form, with shorthand<span><a href="#method-i-create_table-label-Block+form-2C+with+shorthand">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-comment"># You can also use the column types as method calls, rather than calling the column method.</span>
<span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">suppliers</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">string</span> :<span class="ruby-identifier">name</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>
  <span class="ruby-comment"># Other fields here</span>
<span class="ruby-keyword">end</span>
</pre>

<h3 id="method-i-create_table-label-Regular+form">Regular form<span><a href="#method-i-create_table-label-Regular+form">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-comment"># Creates a table called &#39;suppliers&#39; with no columns.</span>
<span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">suppliers</span>)
<span class="ruby-comment"># Add a column to &#39;suppliers&#39;.</span>
<span class="ruby-identifier">add_column</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, {<span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>})
</pre>

<p>The <code>options</code> hash can include the following keys:</p>
<dl class="rdoc-list label-list"><dt><code>:id</code>
<dd>
<p>Whether to automatically add a primary key column. Defaults to true. Join
tables for <a
href="../Associations/ClassMethods.html#method-i-has_and_belongs_to_many">ActiveRecord::Base.has_and_belongs_to_many</a>
should set it to false.</p>

<p>A <a href="../../Symbol.html">Symbol</a> can be used to specify the type of
the generated primary key column.</p>
</dd><dt><code>:primary_key</code>
<dd>
<p>The name of the primary key, if one is to be added automatically. Defaults
to <code>id</code>. If <code>:id</code> is false, then this option is
ignored.</p>

<p>Note that Active Record models will automatically detect their primary key.
This can be avoided by using <a
href="../AttributeMethods/PrimaryKey/ClassMethods.html#method-i-primary_key-3D">self.primary_key=</a>
on the model to define the key explicitly.</p>
</dd><dt><code>:options</code>
<dd>
<p>Any extra options you want appended to the table definition.</p>
</dd><dt><code>:temporary</code>
<dd>
<p>Make a temporary table.</p>
</dd><dt><code>:force</code>
<dd>
<p>Set to true to drop the table before creating it. Set to
<code>:cascade</code> to drop dependent objects as well. Defaults to false.</p>
</dd><dt><code>:as</code>
<dd>
<p>SQL to use to generate the table. When this option is used, the block is
ignored, as are the <code>:id</code> and <code>:primary_key</code> options.</p>
</dd></dl>

<h6 id="method-i-create_table-label-Add+a+backend+specific+option+to+the+generated+SQL+-28MySQL-29">Add a backend specific option to the generated SQL (MySQL)<span><a href="#method-i-create_table-label-Add+a+backend+specific+option+to+the+generated+SQL+-28MySQL-29">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">suppliers</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;ENGINE=InnoDB DEFAULT CHARSET=utf8&#39;</span>)
</pre>

<p>generates:</p>

<pre>CREATE TABLE suppliers (
  id int auto_increment PRIMARY KEY
) ENGINE=InnoDB DEFAULT CHARSET=utf8</pre>

<h6 id="method-i-create_table-label-Rename+the+primary+key+column">Rename the primary key column<span><a href="#method-i-create_table-label-Rename+the+primary+key+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">objects</span>, <span class="ruby-identifier">primary_key</span><span class="ruby-operator">:</span> <span class="ruby-string">&#39;guid&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">string</span>, <span class="ruby-identifier">limit</span><span class="ruby-operator">:</span> <span class="ruby-value">80</span>
<span class="ruby-keyword">end</span>
</pre>

<p>generates:</p>

<pre>CREATE TABLE objects (
  guid int auto_increment PRIMARY KEY,
  name varchar(80)
)</pre>

<h6 id="method-i-create_table-label-Change+the+primary+key+column+type">Change the primary key column type<span><a href="#method-i-create_table-label-Change+the+primary+key+column+type">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">tags</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">string</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">label</span>, :<span class="ruby-identifier">string</span>
<span class="ruby-keyword">end</span>
</pre>

<p>generates:</p>

<pre>CREATE TABLE tags (
  id varchar PRIMARY KEY,
  label varchar
)</pre>

<h6 id="method-i-create_table-label-Do+not+add+a+primary+key+column">Do not add a primary key column<span><a href="#method-i-create_table-label-Do+not+add+a+primary+key+column">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">categories_suppliers</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">category_id</span>, :<span class="ruby-identifier">integer</span>
  <span class="ruby-identifier">t</span>.<span class="ruby-identifier">column</span> :<span class="ruby-identifier">supplier_id</span>, :<span class="ruby-identifier">integer</span>
<span class="ruby-keyword">end</span>
</pre>

<p>generates:</p>

<pre>CREATE TABLE categories_suppliers (
  category_id int,
  supplier_id int
)</pre>

<h6 id="method-i-create_table-label-Create+a+temporary+table+based+on+a+query">Create a temporary table based on a query<span><a href="#method-i-create_table-label-Create+a+temporary+table+based+on+a+query">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">create_table</span>(:<span class="ruby-identifier">long_query</span>, <span class="ruby-identifier">temporary</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>,
  <span class="ruby-identifier">as</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;SELECT * FROM orders INNER JOIN line_items ON order_id=orders.id&quot;</span>)
</pre>

<p>generates:</p>

<pre>CREATE TEMPORARY TABLE long_query AS
  SELECT * FROM orders INNER JOIN line_items ON order_id=orders.id</pre>

<p>See also <a
href="TableDefinition.html#method-i-column">ActiveRecord::ConnectionAdapters::TableDefinition#column</a>
for details on how to create columns.</p>
          
          

          
          <div class="method-source-code" id="create_table-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 267</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">create_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">comment</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-operator">**</span><span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">td</span> = <span class="ruby-identifier">create_table_definition</span> <span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span>[<span class="ruby-value">:temporary</span>], <span class="ruby-identifier">options</span>[<span class="ruby-value">:options</span>], <span class="ruby-identifier">options</span>[<span class="ruby-value">:as</span>], <span class="ruby-identifier">comment</span><span class="ruby-operator">:</span> <span class="ruby-identifier">comment</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:id</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">options</span>[<span class="ruby-value">:as</span>]
    <span class="ruby-identifier">pk</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:primary_key</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-constant">Base</span>.<span class="ruby-identifier">get_primary_key</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">singularize</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">pk</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
      <span class="ruby-identifier">td</span>.<span class="ruby-identifier">primary_keys</span> <span class="ruby-identifier">pk</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">td</span>.<span class="ruby-identifier">primary_key</span> <span class="ruby-identifier">pk</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:id</span>, <span class="ruby-value">:primary_key</span>), <span class="ruby-identifier">options</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">td</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:force</span>]
    <span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-operator">**</span><span class="ruby-identifier">options</span>, <span class="ruby-identifier">if_exists</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">result</span> = <span class="ruby-identifier">execute</span> <span class="ruby-identifier">schema_creation</span>.<span class="ruby-identifier">accept</span> <span class="ruby-identifier">td</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_indexes_in_create?</span>
    <span class="ruby-identifier">td</span>.<span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">index_options</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">index_options</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">supports_comments?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">supports_comments_in_create?</span>
    <span class="ruby-identifier">change_table_comment</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">comment</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">present?</span>

    <span class="ruby-identifier">td</span>.<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">change_column_comment</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">name</span>, <span class="ruby-identifier">column</span>.<span class="ruby-identifier">comment</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span>.<span class="ruby-identifier">comment</span>.<span class="ruby-identifier">present?</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-data_source_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">data_source_exists?</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if the data source <code>name</code> exists on the database.</p>

<pre class="ruby"><span class="ruby-identifier">data_source_exists?</span>(:<span class="ruby-identifier">ebooks</span>)
</pre>
          
          

          
          <div class="method-source-code" id="data_source_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 43</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">data_source_exists?</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">data_source_sql</span>(<span class="ruby-identifier">name</span>), <span class="ruby-string">&quot;SCHEMA&quot;</span>).<span class="ruby-identifier">any?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NotImplementedError</span>
  <span class="ruby-identifier">data_sources</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-data_sources" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">data_sources</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the relation names useable to back Active Record models. For most
adapters this means all <a
href="SchemaStatements.html#method-i-tables">tables</a> and <a
href="SchemaStatements.html#method-i-views">views</a>.</p>
          
          

          
          <div class="method-source-code" id="data_sources-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">data_sources</span>
  <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">data_source_sql</span>, <span class="ruby-string">&quot;SCHEMA&quot;</span>)
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NotImplementedError</span>
  <span class="ruby-identifier">tables</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">views</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-drop_join_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">drop_join_table</span><span
            class="method-args">(table_1, table_2, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Drops the join table specified by the given arguments. See <a
href="SchemaStatements.html#method-i-create_join_table">create_join_table</a>
for details.</p>

<p>Although this command ignores the block if one is given, it can be helpful
to provide one in a migration&#39;s <code>change</code> method so it can be
reverted. In that case, the block will be used by <a
href="SchemaStatements.html#method-i-create_join_table">create_join_table</a>.</p>
          
          

          
          <div class="method-source-code" id="drop_join_table-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 365</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_join_table</span>(<span class="ruby-identifier">table_1</span>, <span class="ruby-identifier">table_2</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">join_table_name</span> = <span class="ruby-identifier">find_join_table_name</span>(<span class="ruby-identifier">table_1</span>, <span class="ruby-identifier">table_2</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">join_table_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-drop_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">drop_table</span><span
            class="method-args">(table_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Drops a table from the database.</p>
<dl class="rdoc-list label-list"><dt><code>:force</code>
<dd>
<p>Set to <code>:cascade</code> to drop dependent objects as well. Defaults to
false.</p>
</dd><dt><code>:if_exists</code>
<dd>
<p>Set to <code>true</code> to only drop the table if it exists. Defaults to
false.</p>
</dd></dl>

<p>Although this command ignores most <code>options</code> and the block if
one is given, it can be helpful to provide these in a migration&#39;s
<code>change</code> method so it can be reverted. In that case,
<code>options</code> and the block will be used by <a
href="SchemaStatements.html#method-i-create_table">create_table</a>.</p>
          
          

          
          <div class="method-source-code" id="drop_table-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 470</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">drop_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;DROP TABLE#{&#39; IF EXISTS&#39; if options[:if_exists]} #{quote_table_name(table_name)}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-foreign_key_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">foreign_key_exists?</span><span
            class="method-args">(from_table, options_or_to_table = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if a foreign key exists on a table for a given foreign key
definition.</p>

<pre class="ruby"><span class="ruby-comment"># Checks to see if a foreign key exists.</span>
<span class="ruby-identifier">foreign_key_exists?</span>(:<span class="ruby-identifier">accounts</span>, :<span class="ruby-identifier">branches</span>)

<span class="ruby-comment"># Checks to see if a foreign key on a specified column exists.</span>
<span class="ruby-identifier">foreign_key_exists?</span>(:<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">owner_id</span>)

<span class="ruby-comment"># Checks to see if a foreign key with a custom name exists.</span>
<span class="ruby-identifier">foreign_key_exists?</span>(:<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;special_fk_name&quot;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="foreign_key_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 973</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">foreign_key_exists?</span>(<span class="ruby-identifier">from_table</span>, <span class="ruby-identifier">options_or_to_table</span> = {})
  <span class="ruby-identifier">foreign_key_for</span>(<span class="ruby-identifier">from_table</span>, <span class="ruby-identifier">options_or_to_table</span>).<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-foreign_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">foreign_keys</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of foreign keys for the given table. The foreign keys are
represented as ForeignKeyDefinition objects.</p>
          
          

          
          <div class="method-source-code" id="foreign_keys-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 877</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">foreign_keys</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;foreign_keys is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-index_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index_exists?</span><span
            class="method-args">(table_name, column_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if an index exists on a table for a given index definition.</p>

<pre class="ruby"><span class="ruby-comment"># Check an index exists</span>
<span class="ruby-identifier">index_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">company_id</span>)

<span class="ruby-comment"># Check an index on multiple columns exists</span>
<span class="ruby-identifier">index_exists?</span>(:<span class="ruby-identifier">suppliers</span>, [:<span class="ruby-identifier">company_id</span>, :<span class="ruby-identifier">company_type</span>])

<span class="ruby-comment"># Check a unique index exists</span>
<span class="ruby-identifier">index_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">company_id</span>, <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)

<span class="ruby-comment"># Check an index with a custom name exists</span>
<span class="ruby-identifier">index_exists?</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">company_id</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;idx_company_id&quot;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="index_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index_exists?</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">column_names</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">column_name</span>).<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>)
  <span class="ruby-identifier">checks</span> = []
  <span class="ruby-identifier">checks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">columns</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">column_names</span> }
  <span class="ruby-identifier">checks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">unique</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:unique</span>]
  <span class="ruby-identifier">checks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:name</span>].<span class="ruby-identifier">to_s</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:name</span>]

  <span class="ruby-identifier">indexes</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">any?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">checks</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">check</span><span class="ruby-operator">|</span> <span class="ruby-identifier">check</span>[<span class="ruby-identifier">i</span>] } }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-index_name_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index_name_exists?</span><span
            class="method-args">(table_name, index_name, default = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Verifies the existence of an index with a given name.</p>
          
          

          
          <div class="method-source-code" id="index_name_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 782</span>
      <span class="ruby-keyword">def</span> <span class="ruby-identifier">index_name_exists?</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">index_name</span>, <span class="ruby-identifier">default</span> = <span class="ruby-keyword">nil</span>)
        <span class="ruby-keyword">unless</span> <span class="ruby-identifier">default</span>.<span class="ruby-identifier">nil?</span>
          <span class="ruby-constant">ActiveSupport</span><span class="ruby-operator">::</span><span class="ruby-constant">Deprecation</span>.<span class="ruby-identifier">warn</span>(<span class="ruby-string">&quot;            Passing default to #index_name_exists? is deprecated without replacement.
&quot;</span>.<span class="ruby-identifier">squish</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">index_name</span> = <span class="ruby-identifier">index_name</span>.<span class="ruby-identifier">to_s</span>
        <span class="ruby-identifier">indexes</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">index_name</span> }
      <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-indexes" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">indexes</span><span
            class="method-args">(table_name, name = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of indexes for the given table.</p>
          
          

          
          <div class="method-source-code" id="indexes-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">indexes</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">name</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;#indexes is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-native_database_types" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">native_database_types</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a hash of mappings from the abstract data types to the native
database types. See <a
href="TableDefinition.html#method-i-column">ActiveRecord::ConnectionAdapters::TableDefinition#column</a>
for details on the recognized abstract data types.</p>
          
          

          
          <div class="method-source-code" id="native_database_types-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 13</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">native_database_types</span>
  {}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-options_include_default-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">options_include_default?</span><span
            class="method-args">(options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="options_include_default-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 1163</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">options_include_default?</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:default</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:null</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:default</span>].<span class="ruby-identifier">nil?</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-primary_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">primary_key</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns just a table&#39;s primary key</p>
          
          

          
          <div class="method-source-code" id="primary_key-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">primary_key</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">pk</span> = <span class="ruby-identifier">primary_keys</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">pk</span> = <span class="ruby-identifier">pk</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pk</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">pk</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_belongs_to" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">remove_belongs_to</span><span
            class="method-args">(table_name, ref_name, foreign_key: false, polymorphic: false, **options)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="SchemaStatements.html#method-i-remove_reference">remove_reference</a>
        </div>
        
      </div>

    
      <div id="method-i-remove_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_column</span><span
            class="method-args">(table_name, column_name, type = nil, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the column from the table definition.</p>

<pre class="ruby"><span class="ruby-identifier">remove_column</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">qualification</span>)
</pre>

<p>The <code>type</code> and <code>options</code> parameters will be ignored
if present. It can be helpful to provide these in a migration&#39;s
<code>change</code> method so it can be reverted. In that case,
<code>type</code> and <code>options</code> will be used by <a
href="SchemaStatements.html#method-i-add_column">add_column</a>.</p>
          
          

          
          <div class="method-source-code" id="remove_column-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 575</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">type</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;ALTER TABLE #{quote_table_name(table_name)} DROP #{quote_column_name(column_name)}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_columns" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_columns</span><span
            class="method-args">(table_name, *column_names)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the given columns from the table definition.</p>

<pre class="ruby"><span class="ruby-identifier">remove_columns</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">qualification</span>, :<span class="ruby-identifier">experience</span>)
</pre>
          
          

          
          <div class="method-source-code" id="remove_columns-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 561</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_columns</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">column_names</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">&quot;You must specify at least one column name. Example: remove_columns(:people, :first_name)&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">column_names</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">column_names</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">column_name</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">remove_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_foreign_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_foreign_key</span><span
            class="method-args">(from_table, options_or_to_table = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the given foreign key from the table. Any option parameters
provided will be used to re-add the foreign key in case of a migration
rollback. It is recommended that you provide any options used when creating
the foreign key so that the migration can be reverted properly.</p>

<p>Removes the foreign key on <code>accounts.branch_id</code>.</p>

<pre class="ruby"><span class="ruby-identifier">remove_foreign_key</span> :<span class="ruby-identifier">accounts</span>, :<span class="ruby-identifier">branches</span>
</pre>

<p>Removes the foreign key on <code>accounts.owner_id</code>.</p>

<pre class="ruby"><span class="ruby-identifier">remove_foreign_key</span> :<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">owner_id</span>
</pre>

<p>Removes the foreign key named <code>special_fk_name</code> on the
<code>accounts</code> table.</p>

<pre class="ruby"><span class="ruby-identifier">remove_foreign_key</span> :<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">special_fk_name</span>
</pre>

<p>The <code>options</code> hash accepts the same keys as <a
href="SchemaStatements.html#method-i-add_foreign_key">#add_foreign_key</a>.</p>
          
          

          
          <div class="method-source-code" id="remove_foreign_key-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 951</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_foreign_key</span>(<span class="ruby-identifier">from_table</span>, <span class="ruby-identifier">options_or_to_table</span> = {})
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">supports_foreign_keys?</span>

  <span class="ruby-identifier">fk_name_to_delete</span> = <span class="ruby-identifier">foreign_key_for!</span>(<span class="ruby-identifier">from_table</span>, <span class="ruby-identifier">options_or_to_table</span>).<span class="ruby-identifier">name</span>

  <span class="ruby-identifier">at</span> = <span class="ruby-identifier">create_alter_table</span> <span class="ruby-identifier">from_table</span>
  <span class="ruby-identifier">at</span>.<span class="ruby-identifier">drop_foreign_key</span> <span class="ruby-identifier">fk_name_to_delete</span>

  <span class="ruby-identifier">execute</span> <span class="ruby-identifier">schema_creation</span>.<span class="ruby-identifier">accept</span>(<span class="ruby-identifier">at</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_index</span><span
            class="method-args">(table_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the given index from the table.</p>

<p>Removes the index on <code>branch_id</code> in the <code>accounts</code>
table if exactly one such index exists.</p>

<pre class="ruby"><span class="ruby-identifier">remove_index</span> :<span class="ruby-identifier">accounts</span>, :<span class="ruby-identifier">branch_id</span>
</pre>

<p>Removes the index on <code>branch_id</code> in the <code>accounts</code>
table if exactly one such index exists.</p>

<pre class="ruby"><span class="ruby-identifier">remove_index</span> :<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">branch_id</span>
</pre>

<p>Removes the index on <code>branch_id</code> and <code>party_id</code> in
the <code>accounts</code> table if exactly one such index exists.</p>

<pre class="ruby"><span class="ruby-identifier">remove_index</span> :<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">column</span><span class="ruby-operator">:</span> [:<span class="ruby-identifier">branch_id</span>, :<span class="ruby-identifier">party_id</span>]
</pre>

<p>Removes the index named <code>by_branch_party</code> in the
<code>accounts</code> table.</p>

<pre class="ruby"><span class="ruby-identifier">remove_index</span> :<span class="ruby-identifier">accounts</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">by_branch_party</span>
</pre>
          
          

          
          <div class="method-source-code" id="remove_index-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 746</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_index</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">index_name</span> = <span class="ruby-identifier">index_name_for_remove</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;DROP INDEX #{quote_column_name(index_name)} ON #{quote_table_name(table_name)}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_reference" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_reference</span><span
            class="method-args">(table_name, ref_name, foreign_key: false, polymorphic: false, **options)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the reference(s). Also removes a <code>type</code> column if one
exists. <a
href="SchemaStatements.html#method-i-remove_reference">remove_reference</a>
and <a
href="SchemaStatements.html#method-i-remove_belongs_to">remove_belongs_to</a>
are acceptable.</p>

<h6 id="method-i-remove_reference-label-Remove+the+reference">Remove the reference<span><a href="#method-i-remove_reference-label-Remove+the+reference">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">remove_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">user</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>

<h6 id="method-i-remove_reference-label-Remove+polymorphic+reference">Remove polymorphic reference<span><a href="#method-i-remove_reference-label-Remove+polymorphic+reference">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">remove_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">supplier</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>

<h6 id="method-i-remove_reference-label-Remove+the+reference+with+a+foreign+key">Remove the reference with a foreign key<span><a href="#method-i-remove_reference-label-Remove+the+reference+with+a+foreign+key">&para;</a> <a href="#top">&uarr;</a></span></h6>

<pre class="ruby"><span class="ruby-identifier">remove_reference</span>(:<span class="ruby-identifier">products</span>, :<span class="ruby-identifier">user</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">foreign_key</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
</pre>
          
          

          
          <div class="method-source-code" id="remove_reference-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 858</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_reference</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">ref_name</span>, <span class="ruby-identifier">foreign_key</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">polymorphic</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-operator">**</span><span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">foreign_key</span>
    <span class="ruby-identifier">reference_name</span> = <span class="ruby-constant">Base</span>.<span class="ruby-identifier">pluralize_table_names</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">ref_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">pluralize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">ref_name</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">foreign_key</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">foreign_key_options</span> = <span class="ruby-identifier">foreign_key</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">foreign_key_options</span> = { <span class="ruby-identifier">to_table</span><span class="ruby-operator">:</span> <span class="ruby-identifier">reference_name</span> }
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">foreign_key_options</span>[<span class="ruby-value">:column</span>] <span class="ruby-operator">||=</span> <span class="ruby-node">&quot;#{ref_name}_id&quot;</span>
    <span class="ruby-identifier">remove_foreign_key</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-operator">**</span><span class="ruby-identifier">foreign_key_options</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">remove_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-node">&quot;#{ref_name}_id&quot;</span>)
  <span class="ruby-identifier">remove_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-node">&quot;#{ref_name}_type&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">polymorphic</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="SchemaStatements.html#method-i-remove_belongs_to">remove_belongs_to</a>
        </div>
        

        
      </div>

    
      <div id="method-i-remove_timestamps" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_timestamps</span><span
            class="method-args">(table_name, options = {})</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes the timestamp columns (<code>created_at</code> and
<code>updated_at</code>) from the table definition.</p>

<pre class="ruby"><span class="ruby-identifier">remove_timestamps</span>(:<span class="ruby-identifier">suppliers</span>)
</pre>
          
          

          
          <div class="method-source-code" id="remove_timestamps-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 1122</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_timestamps</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-identifier">remove_column</span> <span class="ruby-identifier">table_name</span>, <span class="ruby-value">:updated_at</span>
  <span class="ruby-identifier">remove_column</span> <span class="ruby-identifier">table_name</span>, <span class="ruby-value">:created_at</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rename_column" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename_column</span><span
            class="method-args">(table_name, column_name, new_column_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Renames a column.</p>

<pre class="ruby"><span class="ruby-identifier">rename_column</span>(:<span class="ruby-identifier">suppliers</span>, :<span class="ruby-identifier">description</span>, :<span class="ruby-identifier">name</span>)
</pre>
          
          

          
          <div class="method-source-code" id="rename_column-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 631</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_column</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">new_column_name</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;rename_column is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rename_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename_index</span><span
            class="method-args">(table_name, old_name, new_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Renames an index.</p>

<p>Rename the <code>index_people_on_last_name</code> index to
<code>index_users_on_last_name</code>:</p>

<pre class="ruby"><span class="ruby-identifier">rename_index</span> :<span class="ruby-identifier">people</span>, <span class="ruby-string">&#39;index_people_on_last_name&#39;</span>, <span class="ruby-string">&#39;index_users_on_last_name&#39;</span>
</pre>
          
          

          
          <div class="method-source-code" id="rename_index-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 757</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_index</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">old_name</span>, <span class="ruby-identifier">new_name</span>)
  <span class="ruby-identifier">validate_index_length!</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">new_name</span>)

  <span class="ruby-comment"># this is a naive implementation; some DBs may support this more efficiently (Postgres, for instance)</span>
  <span class="ruby-identifier">old_index_def</span> = <span class="ruby-identifier">indexes</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">detect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">i</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">old_name</span> }
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">old_index_def</span>
  <span class="ruby-identifier">add_index</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">old_index_def</span>.<span class="ruby-identifier">columns</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-identifier">new_name</span>, <span class="ruby-identifier">unique</span><span class="ruby-operator">:</span> <span class="ruby-identifier">old_index_def</span>.<span class="ruby-identifier">unique</span>)
  <span class="ruby-identifier">remove_index</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">name</span><span class="ruby-operator">:</span> <span class="ruby-identifier">old_name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rename_table" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rename_table</span><span
            class="method-args">(table_name, new_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Renames a table.</p>

<pre class="ruby"><span class="ruby-identifier">rename_table</span>(<span class="ruby-string">&#39;octopuses&#39;</span>, <span class="ruby-string">&#39;octopi&#39;</span>)
</pre>
          
          

          
          <div class="method-source-code" id="rename_table-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 454</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename_table</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">new_name</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-string">&quot;rename_table is not implemented&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-table_alias_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">table_alias_for</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Truncates a table alias according to the limits of the current adapter.</p>
          
          

          
          <div class="method-source-code" id="table_alias_for-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 27</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">table_alias_for</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">table_name</span>[<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">table_alias_length</span>].<span class="ruby-identifier">tr</span>(<span class="ruby-string">&quot;.&quot;</span>, <span class="ruby-string">&quot;_&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-table_comment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">table_comment</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the table comment that&#39;s stored in database metadata.</p>
          
          

          
          <div class="method-source-code" id="table_comment-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">table_comment</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-table_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">table_exists?</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if the table <code>table_name</code> exists on the database.</p>

<pre class="ruby"><span class="ruby-identifier">table_exists?</span>(:<span class="ruby-identifier">developers</span>)
</pre>
          
          

          
          <div class="method-source-code" id="table_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 58</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">data_source_sql</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;BASE TABLE&quot;</span>), <span class="ruby-string">&quot;SCHEMA&quot;</span>).<span class="ruby-identifier">any?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NotImplementedError</span>
  <span class="ruby-identifier">tables</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-table_options" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">table_options</span><span
            class="method-args">(table_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="table_options-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">table_options</span>(<span class="ruby-identifier">table_name</span>)
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-tables" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">tables</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of table names defined in the database.</p>
          
          

          
          <div class="method-source-code" id="tables-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tables</span>
  <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">data_source_sql</span>(<span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;BASE TABLE&quot;</span>), <span class="ruby-string">&quot;SCHEMA&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-view_exists-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">view_exists?</span><span
            class="method-args">(view_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Checks to see if the view <code>view_name</code> exists on the database.</p>

<pre class="ruby"><span class="ruby-identifier">view_exists?</span>(:<span class="ruby-identifier">ebooks</span>)
</pre>
          
          

          
          <div class="method-source-code" id="view_exists-3F-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 73</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">view_exists?</span>(<span class="ruby-identifier">view_name</span>)
  <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">data_source_sql</span>(<span class="ruby-identifier">view_name</span>, <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;VIEW&quot;</span>), <span class="ruby-string">&quot;SCHEMA&quot;</span>).<span class="ruby-identifier">any?</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">view_name</span>.<span class="ruby-identifier">present?</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">NotImplementedError</span>
  <span class="ruby-identifier">views</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">view_name</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-views" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">views</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns an array of view names defined in the database.</p>
          
          

          
          <div class="method-source-code" id="views-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/2.4.0/gems/activerecord-5.1.5/lib/active_record/connection_adapters/abstract/schema_statements.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">views</span>
  <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">data_source_sql</span>(<span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-string">&quot;VIEW&quot;</span>), <span class="ruby-string">&quot;SCHEMA&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

